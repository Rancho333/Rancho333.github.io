<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Rancho Blog</title>
    <link>https://rancho333.github.io/</link>
    
    <atom:link href="https://rancho333.github.io/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>No pain, no gain!</description>
    <pubDate>Mon, 03 Jul 2023 10:06:07 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>lab考题分析1.13和1.14</title>
      <link>https://rancho333.github.io/2023/07/03/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.13%E5%92%8C1.14/</link>
      <guid>https://rancho333.github.io/2023/07/03/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.13%E5%92%8C1.14/</guid>
      <pubDate>Mon, 03 Jul 2023 07:59:39 GMT</pubDate>
      
      <description>&lt;p&gt;继续考题分析，1.13和1.14。 1.13是让主机拿ip，1.14是选择题。&lt;/p&gt;</description>
      
      
      
      <content:encoded><![CDATA[<p>继续考题分析，1.13和1.14。 1.13是让主机拿ip，1.14是选择题。</p><span id="more"></span><h1 id="1-13-IPv4-networks-on-legacy-Branchs"><a href="#1-13-IPv4-networks-on-legacy-Branchs" class="headerlink" title="1.13 IPv4 networks on legacy Branchs"></a>1.13 IPv4 networks on legacy Branchs</h1><p>下面是题目。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">On sw211 in DC, complete the DHCP server configuration according to these requirements：</span><br><span class="line">1. Create ipv4 DHCP pools named br3_v2000 and br3_v2001 for branch3 vlan2000(10.6.100.0&#x2F;24) and 2001(10.6.101.0&#x2F;24), respectively</span><br><span class="line"></span><br><span class="line">2. Create IPv4 DHCP pool named br4_v1 for the subnet 10.7.1.0&#x2F;24 on branch4.</span><br><span class="line"></span><br><span class="line">3. In each subnet assign addresser from .101 up to .254 inclusively and the appropriate gateway to clients</span><br><span class="line"></span><br><span class="line">On branch3 complete and correct the configuration on switches s601，s602 and s610 to allow HSRP and DHCPrelay operation in vlans 2000 and 2001 according to these requirements：</span><br><span class="line">1. HSRP must implicitly usr the vMAC address range of 0000.0c9f.f000 through 0000.0c9f.ffff</span><br><span class="line"></span><br><span class="line">2. The group number must be 100 for vlan200 and 101 for vlan2001</span><br><span class="line"></span><br><span class="line">3. s601 must be active gateway for vlan2000 with a priority of 110; the active role ownership must be deterministic</span><br><span class="line"></span><br><span class="line">4. sw602 must be active gateway for vlan2001 with a priority of 110; the active role ownership must be deterministic</span><br><span class="line"></span><br><span class="line">5. each active switch must track its uplink interface g0&#x2F;1 and gi0&#x2F;2. If either of these interface goes down, the active switch must allow the other switch to become active. However，it is not allowed for the tracking ro modify the HSRP priority to accomplish this requirements. You must use only one tracking statement when configuring the vlan interfaces for tracking。</span><br><span class="line"></span><br><span class="line">6. Both sw601 and sw602 must be configured as DHCP relay agent in both vlans 2000 and 2001,pointing toward the DHCP server 10.2.255.211 at sw211. however， at anytime， only the active router in the particular vlan should relay the DHCP messages</span><br><span class="line"></span><br><span class="line">7. place host61 and host62 into vlans 2000 and 2001 respectively and make sure they are assigned their correct ipv4 configuration</span><br><span class="line"></span><br><span class="line">8. It is not permitted to use any kind of scripting to complete this task</span><br><span class="line"></span><br><span class="line">On branch4 complete the configuration of the router r70 according to these requirements：</span><br><span class="line">1. assign ip address 10.7.1.1&#x2F;24 to ge0&#x2F;2</span><br><span class="line"></span><br><span class="line">2. enable dhcp relay on this interface and point it to the dhcp server 10.2.255.211 at sw211</span><br><span class="line"></span><br><span class="line">3. It is allowed to add one additional missing command to the r70 configuration to allow clients connected to g0&#x2F;2 obtain their ipv4 configuration</span><br><span class="line"></span><br><span class="line">4. Make sure that host r71 and r72 are assigned their correct ipv4 configuration</span><br></pre></td></tr></table></figure><p>1.13的拓扑如下所示，其中dhcp server sw211没有在图中展示出来：<br><img src="https://rancho333.github.io/pictures/lab_1.13.png"></p><p>1.13很简单，HQ中使用的VRRP，这里使用cisco私有的HSRP做冗余网关，然后jiushi DHCP拿地址。配置思路如下：</p><ul><li>sw211上配置dhcp pool</li><li>sw610配置vlan</li><li>sw601和sw602配置HSRP和dhcp relay</li></ul><p>下面是具体配置：</p><ol><li><p>dhcp pool配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">sw211：</span><br><span class="line">ip dhcp pool br3_v2000</span><br><span class="line">    network 10.6.100.0 255.255.255.0</span><br><span class="line">    default-router 10.6.100.1</span><br><span class="line">ip dhcp pool br3_v2001</span><br><span class="line">    network 10.6.101.0 255.255.255.0</span><br><span class="line">    default-router 10.6.101.1</span><br><span class="line">ip dhcp pool br4_v1</span><br><span class="line">    network 10.7.1.0 255.255.255.0</span><br><span class="line">    default-router 10.7.1.1</span><br><span class="line">ip dhcp exclude-address 10.6.100.0 10.6.100.100</span><br><span class="line">ip dhcp exclude-address 10.6.101.0 10.6.101.100</span><br><span class="line">ip dhcp exclude-address 10.7.1.0 10.7.1.100         &#x2F;&#x2F; 按要求做DHCP配置</span><br></pre></td></tr></table></figure></li><li><p>sw610的vlan配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">vlan 2000                   &#x2F;&#x2F; 预配中只有vlan2001, 补上缺少的vlan 2000</span><br><span class="line">interfac gi0&#x2F;0</span><br><span class="line">    switchport mode access</span><br><span class="line">    switchport access vlan 2000</span><br><span class="line">interface gi0&#x2F;1</span><br><span class="line">    switchport mode access</span><br><span class="line">    switchport access vlan 2001</span><br><span class="line">interface rang gi2&#x2F;0-1</span><br><span class="line">    switchport mode trunk </span><br><span class="line">    switchport trunk all vlan 1,2000-2001</span><br></pre></td></tr></table></figure></li><li><p>HSRP配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">sw601：</span><br><span class="line">interface vlan2000</span><br><span class="line">    standby version2                        &#x2F;&#x2F; 版本必须是2</span><br><span class="line">    standby 100 ip 10.6.100.1</span><br><span class="line">    standby 100 name V2000</span><br><span class="line">    ip helper address 10.2.255.211 redundancy V2000     &#x2F;&#x2F; dhcp 中继配置，关联名称V2000,只有active的路由器发送DHCP请求</span><br><span class="line">    &#x2F;&#x2F; 上面这部分的配置可以直接复制给sw602的vlan 2000</span><br><span class="line"></span><br><span class="line">    standby 100 priority 110</span><br><span class="line">    standby 100 preempt                     &#x2F;&#x2F; hsrp必须开启抢占才能保证优先级大的为active</span><br><span class="line">    standby 100 track 3 shutdown            &#x2F;&#x2F; 任一上行链路down掉，关闭hsrp组，让对端成为active</span><br><span class="line"></span><br><span class="line">sw602：</span><br><span class="line">interface vlan2001</span><br><span class="line">    standby version2</span><br><span class="line">    standby 100 ip 10.6.101.1</span><br><span class="line">    standby 100 name V2001</span><br><span class="line">    ip helper address 10.2.255.211 redundancy V2001     </span><br><span class="line">    上面&#x2F;&#x2F; 这部分的配置可以直接复制给sw601的vlan 2001</span><br><span class="line"></span><br><span class="line">    standby 101 priority 110</span><br><span class="line">    standby 101 preempt</span><br><span class="line">    standby 101 track 3 shutdown        </span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 考场上需要检查每个vlan的预配，如果有standby 0的配置要全部清除掉</span><br><span class="line"></span><br><span class="line">sw601&#x2F;sw602：</span><br><span class="line">track 1 interface gi0&#x2F;1 line-protocol</span><br><span class="line">track 2 int gi0&#x2F;2 line-protocol</span><br><span class="line">track 3 list bool and           &#x2F;&#x2F; 1和2同时up，3才是up</span><br><span class="line">    object 1</span><br><span class="line">    object 2</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; r70上缺少网关，dhcp中继，以及网关路由的配置，就在这里补吧</span><br><span class="line">r70：</span><br><span class="line">interface gi0&#x2F;2</span><br><span class="line">    ip address 10.7.1.1 255.255.255.0 </span><br><span class="line">    ip help-address 10.2.255.211</span><br><span class="line">    no shutdown </span><br><span class="line">router eigrp ccie</span><br><span class="line">    address-family ipv4 unicast autonomous-system 65006</span><br><span class="line">        network 10.7.1.0 0.0.0.255              &#x2F;&#x2F; 在eigrp中通过网关路由</span><br></pre></td></tr></table></figure></li></ol><p>配置完成之后，sw211为4台host分配ip：<br><img src="https://rancho333.github.io/pictures/lab_1.13_dhcp.png"></p><p>验证HSRP的配置，sw601在vlan2000中是active，在vlan2001中是standby<br><img src="https://rancho333.github.io/pictures/lab_1.13_stanby.png"></p><p>验证track，将sw601的上行口关闭，sw601上standby 100关闭，sw602成为vlan2000的active。其实只用关闭一个上行口就行，这里关了两个。<br><img src="https://rancho333.github.io/pictures/lab_1.13_track.png"></p><h1 id="1-14-Multicast-in-fabd2"><a href="#1-14-Multicast-in-fabd2" class="headerlink" title="1.14 Multicast in fabd2"></a>1.14 Multicast in fabd2</h1><p>考题如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Fabd2 is preparing to enable PIM sparse mode multicast routing in its network. As a port of validating the runbooks，fabd2 requies a sanity check to prevent inappropriate use of multicast related configuration commands on different router types.</span><br><span class="line"></span><br><span class="line">First hop routers: routers where multicast source are connected</span><br><span class="line">Last hop routers：routers where multicast receivers(subscribers) are connected</span><br><span class="line">Intermediary Hop Routers - routers on the path between first hop and last hop routers</span><br><span class="line"></span><br><span class="line">In the table below，for each configuration command，select all router types where the use of the command is appropriate.(select all that apply)</span><br></pre></td></tr></table></figure><table><thead><tr><th align="left"></th><th align="left">last hop router</th><th align="left">first hop router</th><th align="left">intermediary hop router</th></tr></thead><tbody><tr><td align="left">ip pim spt-threshold</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">ip igmp version</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">ip pim register-source</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">ip pim sparse-mode</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">ip pim rp-address</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">ip pim passive</td><td align="left"></td><td align="left"></td><td align="left"></td></tr></tbody></table><p>解法如下：</p><table><thead><tr><th align="left"></th><th align="left">last hop router</th><th align="left">first hop router</th><th align="left">intermediary hop router</th></tr></thead><tbody><tr><td align="left">ip pim spt-threshold</td><td align="left">Y</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">ip igmp version</td><td align="left">Y</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">ip pim register-source</td><td align="left"></td><td align="left">Y</td><td align="left"></td></tr><tr><td align="left">ip pim sparse-mode</td><td align="left">Y</td><td align="left">Y</td><td align="left">Y</td></tr><tr><td align="left">ip pim rp-address</td><td align="left">Y</td><td align="left">Y</td><td align="left">Y</td></tr><tr><td align="left">ip pim passive</td><td align="left">Y</td><td align="left">Y</td><td align="left"></td></tr></tbody></table><p>基本说明如下：</p><ul><li>spt(short path tree), 最短路径树，一般在最后一条开启，用于和source之间建立最短路径树。貌似也可以在RP上开启</li><li>igmp当然是最后一跳了</li><li>refister-source   指定发送register报文的源ip，类似ping指定源，用于第一跳向RP发送register报文使用</li><li>sparse mode用于指定PIM的模式，所有路由器都可配置</li><li>指定静态指定RP的地址，所有路由器都可配置；另外一种方式就是自动选举RP了</li><li>pim的被动端口，和ospf，eigrp的被动端口效果类似，不发送和处理pim报文，末节路由器，也就是用在主机侧了，source和receiver都是主机，first和last都选上</li></ul>]]></content:encoded>
      
      
      
      <category domain="https://rancho333.github.io/tags/CCIE/">CCIE</category>
      
      
      <comments>https://rancho333.github.io/2023/07/03/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.13%E5%92%8C1.14/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>lab考题分析1.11和1.12</title>
      <link>https://rancho333.github.io/2023/07/03/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.11%E5%92%8C1.12/</link>
      <guid>https://rancho333.github.io/2023/07/03/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.11%E5%92%8C1.12/</guid>
      <pubDate>Mon, 03 Jul 2023 03:54:32 GMT</pubDate>
      
      <description>&lt;p&gt;继续考题分析，1.11和1.12. 主要是DMVPN相关。简单概括下，1.11是修复DMVPN；1.12是通过隧道建立eigrp下发默认路由.&lt;/p&gt;</description>
      
      
      
      <content:encoded><![CDATA[<p>继续考题分析，1.11和1.12. 主要是DMVPN相关。简单概括下，1.11是修复DMVPN；1.12是通过隧道建立eigrp下发默认路由.</p><span id="more"></span><h1 id="1-11-Fixing-broken-DMVPN-between-DC-and-Branch3-amp-4"><a href="#1-11-Fixing-broken-DMVPN-between-DC-and-Branch3-amp-4" class="headerlink" title="1.11 Fixing broken DMVPN between DC and Branch3&amp;4"></a>1.11 Fixing broken DMVPN between DC and Branch3&amp;4</h1><p>下面是考题：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Correct the configuration issues resulting in Broken DMVPN tunnel connectivity between DC, branch3 and branch4 according to these requirements：</span><br><span class="line"></span><br><span class="line">1. The DMVPN must operate ip IPsec-protected Phase 3 mode</span><br><span class="line"></span><br><span class="line">2. Using the FVRF approach,safeguard the DMVPN operation against any potential recursive</span><br><span class="line"></span><br><span class="line">3. Do not create any new vrfs</span><br><span class="line"></span><br><span class="line">4. Do not change the tunnel source commands on tunnel interfaces</span><br><span class="line"></span><br><span class="line">5. On spoken do not add new BGP neighbors；reuse those that currently up while changing their VRF members as needed</span><br><span class="line"></span><br><span class="line">6. It is not allowed to modify configuration on DC r24 to complete this entire task.</span><br></pre></td></tr></table></figure><p>1.11的拓扑如下所示：<br><img src="https://rancho333.github.io/pictures/lab_1.11.png"></p><p>共涉及到4台设备，分别是r24,r61,r62,r70，其中r24作为hub已经预配好，不能做配置改动。r61,r62，r70作为spoken，与r24一同组成DMVPN网络。配置思路如下：</p><ul><li>将r61,r62的对应接口加入vrf WAN中，并修改为正确的BGP邻居配置</li><li>配置tunnel0接口，配置加密信息</li></ul><p>下面是具体配置：</p><ol><li>配置接口信息及BGP<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">r61:</span><br><span class="line">int gi0&#x2F;0</span><br><span class="line">    vrf forwarding WAN              &#x2F;&#x2F; 实现F-VRF配置</span><br><span class="line">    ip address 100.5.61.2 255.255.255.252</span><br><span class="line">int lo0</span><br><span class="line">    vrf forwading WAN</span><br><span class="line">    ip add 10.6.255.61 255.255.255.255      &#x2F;&#x2F; 将lo0也加入vrf中，用于做tunnel的源地址</span><br><span class="line"></span><br><span class="line">router bgp 65006</span><br><span class="line">    bgp router-id 10.6.255.61</span><br><span class="line">    no neighbor 100.5.61.1 remote-as 10000</span><br><span class="line">    no network 10.6.255.61 mask 255.255.255.255   &#x2F;&#x2F; 删除预配的无用信息</span><br><span class="line">    address-family ipv4 vrf WAN中</span><br><span class="line">        neighbor 100.5.61.1 remote-as 10000         &#x2F;&#x2F; 在vrf地址族下配置邻居并通告路由，邻居会自动激活</span><br><span class="line">        network 10.6.255.61 mask 255.255.255.255</span><br><span class="line"></span><br><span class="line">r62:</span><br><span class="line">    int gi0&#x2F;0</span><br><span class="line">        vrf forwarding WAN</span><br><span class="line">        ip address 100.6.62.2 255.255.255.252</span><br><span class="line">    int lo0</span><br><span class="line">        vrf forwarding WAN</span><br><span class="line">        ip address 10.6.255.62 mask 255.255.255.255</span><br><span class="line">    </span><br><span class="line">    router bgp 65006 </span><br><span class="line">        bgp router-id 10.6.255.62</span><br><span class="line">        no neighbor 100.6.62.1 remote-as 10000</span><br><span class="line">        no network 10.6.255.62 mask 255.255.255.255</span><br><span class="line">        address-family ipv4 vrf WAN</span><br><span class="line">            neighbor 100.6.62.1 remote-as 10000</span><br><span class="line">            network 10.6.255.62 mask 255.255.255.255</span><br></pre></td></tr></table></figure></li></ol><p>配置完成之后，r61与r5建立eBGP邻居，r62与r6建立eBGP邻居。<br><img src="https://rancho333.github.io/pictures/lab_1.11_bgp_neighbor.png"></p><p>HQ中通过BGP学到r61和r62的lo0路由, 可以ping通。<br><img src="https://rancho333.github.io/pictures/lab_1.11_ping_r61_r62.png"></p><ol start="2"><li>配置tunnel信息以及加密信息：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">r61&#x2F;62&#x2F;70:</span><br><span class="line">int t0</span><br><span class="line">    ip nhrp nhs 10.200.0.1                  &#x2F;&#x2F; spoken配置nhs服务端为10.200.0.1</span><br><span class="line">    ip nhrp map multicast 10.2.255.24       &#x2F;&#x2F; 配置nhs组播映射为10.2.255.24</span><br><span class="line">    ip nhrp map 10.200.0.1 10.2.255.24      &#x2F;&#x2F; 配置单播映射10.200.0.1为10.2.255.24</span><br><span class="line">    ip nhrp network-id 1010                    &#x2F;&#x2F; 配置netwoek-id为1010，与hub保持一致</span><br><span class="line">    tunnel source lo0                           &#x2F;&#x2F; 隧道源为lo0</span><br><span class="line">    tunnel mode gre multipoint                  &#x2F;&#x2F; 隧道模式为mgre</span><br><span class="line">    tunnel protection ipsec profile profile     &#x2F;&#x2F; 加载ipsec配置文件prof</span><br><span class="line">    ip nhrp shortcut                            &#x2F;&#x2F; 开启NHRP最短路径切换</span><br><span class="line">    no ip nhrp redirect                     &#x2F;&#x2F; spoken上关闭nhrp重定向</span><br><span class="line">    ip mtu 1440                             &#x2F;&#x2F; 保持与hub相同的接口参数属性</span><br><span class="line">    tunnel vrf WAN                          &#x2F;&#x2F; NHRP在进行单播和组播映射时，隧道的公网由10.2.255.24在VRF路由表WAN中查找</span><br><span class="line">    no ip nhrp map multicast dynamic        &#x2F;&#x2F; spoken站点不需要配置动态组播，hub才需要</span><br><span class="line"></span><br><span class="line">加密相关配置从r70 copy即可，注意修改</span><br><span class="line">hash sha 就行</span><br></pre></td></tr></table></figure></li></ol><p>配置完成之后，在r24上检查ipsec会话时候正常建立,如果没有正常建立，尝试将对应的t0接口关闭再开启。<br><img src="https://rancho333.github.io/pictures/lab_1.11_crypto.png"></p><p>验证spoken站点的单播和组播映射：<br><img src="https://rancho333.github.io/pictures/lab_1.11_nhrp.png"></p><p>至此，说明DMVPN就建立成功了。实际的配置过程中，可以以r70的配置为模板，增减一些配置，然后贴到r61和r62上去，此外r61上需要去除错误的nhrp单播映射配置。</p><p>如果没有正常建立, 排查思路如下：</p><ul><li>路由是否正常，r24上需要有三个spoken的lo0路由，spoken上需要有hub的lo0路由（隧道的underlay是要三层可达的）</li><li>t0接口配置是否正常</li><li>加密相关配置是否正常</li></ul><p>对于DMVPN的phase3, 简单描述即：spoken之间的第一次会话是通过hub转发的，之后就是spoken之间直接建立tunnel进行会话，通过tracroute根据两次会话的路径可以看到现象。</p><h1 id="1-12-Tuning-EIGRP-on-DMVPN-and-DMVPN-enabled-sites"><a href="#1-12-Tuning-EIGRP-on-DMVPN-and-DMVPN-enabled-sites" class="headerlink" title="1.12 Tuning EIGRP on DMVPN and DMVPN-enabled sites"></a>1.12 Tuning EIGRP on DMVPN and DMVPN-enabled sites</h1><p>下面是考题。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Optimize the DMVPN operation according to these requirements</span><br><span class="line">1. Ensure that branch3&amp;4 can receive only a default route over EIGRP in DMVPN</span><br><span class="line"></span><br><span class="line">2. The default route originate must be done on r24 without the use of any static routes，redistribute，or route filtering</span><br><span class="line"></span><br><span class="line">3. It is not allowed to modify the configuration of r61 and r62 in branch3 to accomplish this task</span><br><span class="line"></span><br><span class="line">4. It is allowed to add commands on the configuration of r70 in branch4 to accomplish this task； none of existing configuration on r70 may be removed to accomplish this task</span><br><span class="line"></span><br><span class="line">configure sw601 and sw602 at branch3 according to these requirements:</span><br><span class="line">1. routers r61 and r62 must not send EIGRP queries to sw601 and sw602</span><br><span class="line"></span><br><span class="line">2. switches sw601 and sw602 must allow advertising any current or future directly connected network to r61 and r62 after the network is added to EIGRP</span><br><span class="line"></span><br><span class="line">3. switches sw601 and sw602 must continue to propagate the default route received from r61 and r62 to each other. To select the default route ，use a prefix list with a &#39;permit&#39; type entry only</span><br><span class="line"></span><br><span class="line">4. Switches sw601 and sw602 must not propagate the default route back to r61 and r62</span><br><span class="line"></span><br><span class="line">5. If the prefix list that allows the propagation of selected EIGRP learned networks between sw601 and sw602 is modified in the future，the same set of networks must be disallowed from being advertised back to r61 and r62 automatically，without any additional configuration。</span><br></pre></td></tr></table></figure><p>1.12的拓扑如下图所示<br><img src="https://rancho333.github.io/pictures/lab_1.12.png"></p><p>总共涉及到4台设备，分别是r24,s601,s602,r70, r24没在拓扑中体现出来。在1.11构建好的DMVPN基础上，基于tunnel0接口建立EIGRP邻居，hub通过eigrp下发默认路由，s601和s602上做路由策略对默认路由做相应控制。配置思路如下：</p><ul><li>建立EIGRP邻居，r24下发默认路由</li><li>s601和s602上创建两个route-map，LEAKMAP用于相互泄漏默认路由，DIS用于给r61，62泄漏除默认路由之外的路由</li><li>完成1.8的部分需求，泄漏10.6和10.200网段路由到ospf中</li></ul><p>下面是解法。</p><ol><li>EIGRP邻居及默认路由<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">r24:</span><br><span class="line">ruter eigrp ccie    </span><br><span class="line">    address-family ipv4 unicast autonomous-system 65006</span><br><span class="line">    af-interface t0</span><br><span class="line">        no passive-interface            &#x2F;&#x2F; r24和r70的t0被配置为passive-if, 无法建立eigrp邻居, r70上也需要做该操作</span><br><span class="line">        </span><br><span class="line">        summary-address 0.0.0.0 0.0.0.0     &#x2F;&#x2F; 在隧道接口进行路由汇总，给spoken下发默认路由</span><br><span class="line">    topology base</span><br><span class="line">        summary-metric 0.0.0.0&#x2F;0 distance 125</span><br><span class="line">    &#x2F;&#x2F; eigrp手动汇总后，本地生产一条AD为5的默认路由指向null0，用于防环</span><br><span class="line">    &#x2F;&#x2F; 修改这条默认路由的AD为125, 在1.16中ISP会下发默认路由，不然会有冲突</span><br></pre></td></tr></table></figure></li></ol><p>配置完成后，r24上可以看到3个eigrp邻居<br><img src="https://rancho333.github.io/pictures/lab_1.12_eigrp_tunnel_neighbor.png"></p><p>在spoken上可以看到hub通过eigrp下发的默认路由：<br><img src="https://rancho333.github.io/pictures/lab_1.12_dis_default.png"></p><ol start="2"><li>路由泄漏<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">sw601&#x2F;602:</span><br><span class="line">ip prefix-list DEFAULT permit 0.0.0.0&#x2F;0     &#x2F;&#x2F; 前缀列表匹配默认路由</span><br><span class="line"></span><br><span class="line">route-map LEAKMAP permit 10</span><br><span class="line">    match ip address prefix-list DEFAULT    &#x2F;&#x2F; 创建route-map LEAKMAP只允许默认路由通过</span><br><span class="line"></span><br><span class="line">route-map DIS deny 10 </span><br><span class="line">    match ip address prefix-list DEFAULT</span><br><span class="line">route-map DIS permit 20                 &#x2F;&#x2F; 创建route-map过滤sw601&#x2F;602传递给r61,62的路由。当前是传递除了默认路由之外的所有路由，将来即使修改了prefix-list, 匹配的路由依然不会传递给r61,62</span><br><span class="line"></span><br><span class="line">ruter eigrp ccie    </span><br><span class="line">    address-family ipv4 unicast autonomous-system 65006</span><br><span class="line">    af-interface vlan2000</span><br><span class="line">        passive-if</span><br><span class="line">    af-interface vlan2001</span><br><span class="line">        passive-if          &#x2F;&#x2F; 末节设备连接主机的L3接口配置成被动接口，不建立邻居，和1.4中的ospf是一个意思</span><br><span class="line">    </span><br><span class="line">    eigrp stub          &#x2F;&#x2F; 配置sw601和sw602为末节路由器</span><br><span class="line">    eigrp stub connected leak-map LEAKMAP   &#x2F;&#x2F; 使用route-map对末节路由器进行路由泄漏</span><br><span class="line"></span><br><span class="line">    topology base</span><br><span class="line">        distribute-list route-map DIS out gi0&#x2F;1</span><br><span class="line">        distribute-list route-map DIS out gi0&#x2F;2        &#x2F;&#x2F; 配置出方向分发列表，防止将来s601,602修改前缀列表将路由回馈给61，62</span><br></pre></td></tr></table></figure></li></ol><p>对于leakmap进行测试验证，正常情况下s601的默认路由从r61,62走ecmp：<br><img src="https://rancho333.github.io/pictures/lab_1.12_601_route.png"></p><p>将s601的上行接口关闭，此时通过leakmap从s602泄漏过来的默认路由将被优选：<br><img src="https://rancho333.github.io/pictures/lab_1.12_leakmap.png"></p><p>对于distribte-list进行测试验证，对于r61和62, 将上行接口均关闭，不会接收到从s601和s602回馈的默认路由即为成功.<br><img src="https://rancho333.github.io/pictures/lab_1.12_no_default.png"></p><ol start="3"><li>1.8的路由<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">R24：</span><br><span class="line">ip prefix-list DMVPN seq 5 permit 10.6.0.0&#x2F;15 le 32</span><br><span class="line">ip prefix-list DMVPN seq 10 permit 10.200.0.0&#x2F;24            &#x2F;&#x2F; 创建前缀列表匹配需求中的路由，10.6是br3中的，10.200是tunnel的</span><br><span class="line"></span><br><span class="line">route-map DMVPN permit 10</span><br><span class="line">    match ip addpress prefix-list DMVPN</span><br><span class="line"></span><br><span class="line">router ospf 1</span><br><span class="line">    redistribute eigrp 65006 subnets route-map DMVPN     &#x2F;&#x2F; 从eigrp中导入指定范围的路由</span><br><span class="line">    summary-address 10.6.0.0 255.254.0.0 tag 123</span><br><span class="line">    summary-address 10.200.0.0 255.255.255.0 tag 123        &#x2F;&#x2F; ASBR上进行路由汇总，避免路由过多。同时打上tag，避免路由这些路由通过r11到r3回到DC，过滤的动作在1.9中做了</span><br></pre></td></tr></table></figure>在DC中的设备上可以看到汇总后的两个网段的路由：<br><img src="https://rancho333.github.io/pictures/lab_1.12_ospf_summary.png"></li></ol><p>注意，此时s601和s602的vlan2000,2001应该可以ping通dhcp server<br><img src="https://rancho333.github.io/pictures/lab_1.12_vlan2000_dhcp.png"></p><p>如果不能ping通，后续的DHCP不会成功。如果通，分别在：</p><ul><li>r61上检查vlan2000的路由，没有则是route-map配置有问题</li><li>sw211上检查vlan2000的路由，没有则是ospf重分发或者eigrp上的问题</li></ul><p>干到这里，基本上为host61,62,71,72从DHCP server拿ip打下了基础。</p>]]></content:encoded>
      
      
      
      <category domain="https://rancho333.github.io/tags/CCIE/">CCIE</category>
      
      
      <comments>https://rancho333.github.io/2023/07/03/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.11%E5%92%8C1.12/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>lab考题分析1.10</title>
      <link>https://rancho333.github.io/2023/07/03/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.10/</link>
      <guid>https://rancho333.github.io/2023/07/03/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.10/</guid>
      <pubDate>Mon, 03 Jul 2023 02:17:29 GMT</pubDate>
      
      <description>&lt;p&gt;继续考题分析1.10. 这题是对BGP peer group以及部分mpls的考察。&lt;/p&gt;</description>
      
      
      
      <content:encoded><![CDATA[<p>继续考题分析1.10. 这题是对BGP peer group以及部分mpls的考察。</p><span id="more"></span><h1 id="Bringing-up-VPNv4-and-VPNv6-in-SP1"><a href="#Bringing-up-VPNv4-and-VPNv6-in-SP1" class="headerlink" title="Bringing up VPNv4 and VPNv6 in SP1"></a>Bringing up VPNv4 and VPNv6 in SP1</h1><p>下面是考题。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Configure routers r3,r4,r5,r6 in SP1 according to these requirements.</span><br><span class="line"></span><br><span class="line">Configure r3 through r6mutual vpnv4 and vpnv6 route exchange</span><br><span class="line"></span><br><span class="line">configgure r3 as a router-reflector</span><br><span class="line"></span><br><span class="line">configure r4,r5 and r6 as clients of router-reflector</span><br><span class="line"></span><br><span class="line">use minimal configuration for achieving this task</span><br><span class="line"></span><br><span class="line">use peer-group GlobalSP</span><br><span class="line"></span><br><span class="line">use lo0 ipv4 addresses for peering</span><br><span class="line"></span><br><span class="line">configuration r3 through r6 to assign(allocate&#x2F;bind) as few unique MPLS labels to all existing and future vpnv4 and vpnv6 routes as possible.</span><br><span class="line"></span><br><span class="line">on routers r3 through r6，prevent any existing and future customer from discovering detail about the inter topology of SP1, it is not allowed to use ACLs to accomplish this requirement.</span><br></pre></td></tr></table></figure><p>lab1.10的拓扑如下<br><img src="https://rancho333.github.io/pictures/lab_1.10.png"></p><p>共涉及到4台设备，分别是r3,r4,r5,r6，其中r1,r2的所有接口开启mpls，SP1中就是典型<code>f-VRF+MPLS</code>的拓扑。r3作为bgp的路由反射器，通过peer group与另外三台建立邻居，r4,5,6作为客户端。此外，配置mpls隐藏sp1内部拓扑，相同vpn使用同一个lable。</p><p>配置思路如下：</p><ul><li>配置r3作为路由反射器，与r4,5,6建立iBGP邻居</li><li>配置mpls</li><li>分别配置r4,5,6与r3建立iBGP邻居</li></ul><p>解法如下：</p><ol><li><p>配置r3</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">router bgp 10000</span><br><span class="line">    bgp router-id 100.255.54.3          &#x2F;&#x2F; 手动配置bgp router-id</span><br><span class="line">    no bgp default ipv4-unicast         &#x2F;&#x2F; 不默认激活ipv4邻居</span><br><span class="line"></span><br><span class="line">    neighbor GlobalSP peer-group</span><br><span class="line">    neighbor GlobalSP remote-as 10000</span><br><span class="line">    neighbor GlobalSP update-source lo0        &#x2F;&#x2F; 配置对等体</span><br><span class="line"></span><br><span class="line">    neighbor 100.255.254.4 peer-group GlobalSP</span><br><span class="line">    neighbor 100.255.254.5 peer-group GlobalSP</span><br><span class="line">    neighbor 100.255.254.6 peer-group GlobalSP  &#x2F;&#x2F; 给对等体添加成员</span><br><span class="line"></span><br><span class="line">    address-family vpnv4</span><br><span class="line">        neighbor 100.255.254.4 active</span><br><span class="line">        neighbor 100.255.254.5 active</span><br><span class="line">        neighbor 100.255.254.6 active           &#x2F;&#x2F; 激活对等体中的邻居</span><br><span class="line">        neighbor GlobalSP route-reflector-client    &#x2F;&#x2F; 配置RR客户端</span><br></pre></td></tr></table></figure></li><li><p>配置mpls</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">r3,4,5,6：</span><br><span class="line">mpls label all-vrfs protocol bgp-vpnv4 per-vrf</span><br><span class="line">mpls label all-vrfs protocol bgp-vpnv6 per-vrf      &#x2F;&#x2F; vpnv4和vpnv6所有的地址族，基于每一个vrf一个标签</span><br><span class="line">no mpls ip propagate-ttl forwarded          &#x2F;&#x2F; 在mpls域内的边界PE上关闭TTL繁衍，防止mpls内部拓扑被发现</span><br></pre></td></tr></table></figure></li><li><p>配置r4,5,6</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">router bgp 10000</span><br><span class="line">    no bgp default ipv4-unicast</span><br><span class="line">    bgp router-id 100.255.254.4&#x2F;5&#x2F;6</span><br><span class="line"></span><br><span class="line">    neighbor 100.255.254.3 remote-as 10000</span><br><span class="line">    neighbor 100.255.254.3 update-source lo0</span><br><span class="line">    address vpnv4</span><br><span class="line">        neighbor 100.255.254.3 active</span><br><span class="line">    address vpnv6</span><br><span class="line">        neighbor 100.255.254.3 active        &#x2F;&#x2F; 在vpnv4和vpnv6下分别激活邻居</span><br></pre></td></tr></table></figure></li></ol><p>配置完成之后在r3上查看bgp邻居，在vpnv4和vpnv6下分别与r4,5,6建立bgp邻居，vpnv4下另外两个邻居r11和r21是在1.9中建立的。<br><img src="https://rancho333.github.io/pictures/lab_1.10_neighbor.png"></p><p>label这玩意也不是太懂，加个配置就行了，现象后面再研究吧。R70的lo0已经预配通过BGP通告路由，R11现在可以ping通<code>10.7.255.70</code>.<br><img src="https://rancho333.github.io/pictures/lab_1.10_ping_r70.png"></p><p>通过tracroute解析每一跳，可以发现SP1中的路径被隐藏。<br><img src="https://rancho333.github.io/pictures/lab_1.10_tracroute_r70.png"></p>]]></content:encoded>
      
      
      
      <category domain="https://rancho333.github.io/tags/CCIE/">CCIE</category>
      
      
      <comments>https://rancho333.github.io/2023/07/03/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.10/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>lab考题分析1.8与1.9</title>
      <link>https://rancho333.github.io/2023/06/29/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.8%E4%B8%8E1.9/</link>
      <guid>https://rancho333.github.io/2023/06/29/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.8%E4%B8%8E1.9/</guid>
      <pubDate>Thu, 29 Jun 2023 08:57:46 GMT</pubDate>
      
      <description>&lt;p&gt;继续考题分析，1.8与1.9&lt;/p&gt;</description>
      
      
      
      <content:encoded><![CDATA[<p>继续考题分析，1.8与1.9</p><span id="more"></span><h1 id="1-8-OSPFv2-in-DC"><a href="#1-8-OSPFv2-in-DC" class="headerlink" title="1.8 OSPFv2 in DC"></a>1.8 OSPFv2 in DC</h1><p>考题如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Configure device in the DC according to these requirements：</span><br><span class="line">1. Switches sw201 and sw202 must establish a stable OSPF adjacency in the Full state with vedge21 and vedge22 on interface vlan3999. Any configuration changes and corrections necessary to meet this requirement may be performed only on the switches and any mismatced parameters causing the issue must be changed to exactly match the configuration of the vedges</span><br><span class="line"></span><br><span class="line">2. All OSPF speakers in the DC running Cisco IOS and IOS-XE software must be configured to keep the number of advertised internal routes to an absolute minimum while not impacting the reachability of the services. This include the reachability of ISE, DNA center，vManage，vBond，vSmart on their internal addresses as well as any existing and future in vlan4000 on sw201 and sw202. The configuration of this requirement must be completed exclusively within the &#39;router ospf&#39; and &#39;interface vlan&#39; context without causing any impact to existing OSPF adjacencies。</span><br><span class="line"></span><br><span class="line">3. Router r24 must advertise two prefixes，10.6.0.0&#x2F;15 and 10.200.0.0&#x2F;24 as Type-5 LSAs in ODPFv2 to provide HQ and DC with the reachability to the DMVPN tunnel and Branch3,4. The configuration of this requirement must be completed exclusively within the &#39;router ospf&#39; context.</span><br><span class="line"></span><br><span class="line">4. Any route from 10.2.0.0&#x2F;16 range that keeps being advertised in OSPF must continue being advertised an intra-area route.</span><br><span class="line"></span><br><span class="line">5. It is not allowed to modify existing areas to accomplish this entire task.</span><br></pre></td></tr></table></figure><p>1.8的拓扑示意如下：</p><p><img src="https://rancho333.github.io/pictures/lab_1.8.png"></p><p>总共涉及到8台设备，分别是sw201,sw202,sw211,sw212,r21,r22,r23,r24. 其中sw201，sw202与vedge21，vedge22建立ospf邻居关系，示意如下：</p><p><img src="https://rancho333.github.io/pictures/lab_1.8_vedge.png"></p><p>拓扑简要说明下：</p><ul><li>sw201,sw202与vedge相连的接口均为trunk，native vlan为4000, 对于vedge而言这是vpn0 underlay</li><li>vedge上创建子接口与sw的vlan 3999对接，作为vpn999的接口</li><li>vedge21上两个物理口分别与两台sw相连，sw201在201网段(再子网划分给vlan3999和4000),sw202在202网段，这是为了冗余吧</li><li>sw101的vlan3999,vlan4000与vedge21的0/1, 0/1.3999分别建立ospf邻居，与vedge22同理，所以sw201上vlan3999有两个ospf零件，vlan4000中也是两个； sw202同理</li></ul><p>解法如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">sw201&#x2F;sw202：</span><br><span class="line">interface vlan3999 </span><br><span class="line">    ip mtu 1496        &#x2F;&#x2F; 修复与vedge子接口的ospf邻居，vedge子接口MTU需要减去4字节的vlan tag</span><br><span class="line"></span><br><span class="line">router ospf 1</span><br><span class="line">    prefix-suppression      &#x2F;&#x2F; 开启ospf前缀抑制，减少路由器之间相连网段的路由</span><br><span class="line"></span><br><span class="line">interface range vlan 3999-4000</span><br><span class="line">    ip ospf prefix-supression disable       &#x2F;&#x2F; 与vedge相连的接口不抑制</span><br><span class="line">    shutdown </span><br><span class="line">    no shutdown             &#x2F;&#x2F; 重新建立连接，否则DC区域可能无法正常学习到br1和br2的路由，直接导致br1，br2无法连接到DNAc，显示unreachreable</span><br><span class="line"></span><br><span class="line">sw211：</span><br><span class="line">    router ospf 1</span><br><span class="line">        prefix-supression</span><br><span class="line">        passive-interface gi1&#x2F;1</span><br><span class="line">        passive-interface gi1&#x2F;2</span><br><span class="line">        passive-interface gi1&#x2F;3</span><br><span class="line"></span><br><span class="line">sw212：</span><br><span class="line">    router ospf 1</span><br><span class="line">        prefix-supression</span><br><span class="line">        passive-interface gi1&#x2F;1</span><br><span class="line">        passive-interface gi1&#x2F;2     &#x2F;&#x2F; 与DNAc等相连的不抑制</span><br><span class="line"></span><br><span class="line">r21,r22,r23,r24：</span><br><span class="line">    router ospf 1</span><br><span class="line">        prefix-supression</span><br><span class="line">    </span><br></pre></td></tr></table></figure><p>配置完成之后，sw201与sw202上与vedge建立ospf邻居：<br><img src="https://rancho333.github.io/pictures/1.8_ospf_neig.png"></p><p>sw201上查看路由抑制效果：<br><img src="https://rancho333.github.io/pictures/lab_1.8_route.png"></p><p>ospf路由表说明如下：</p><ul><li>总共另外7台设备<code>/32</code>的loopback路由，loopback接口不抑制</li><li>总共有5个<code>/24</code>网段路由，对应vManage，vsmart，vbond，DNAc和ISE</li><li>2个<code>/29</code>网段路由，分别从sw202和vedge22学到，所以ECMP</li></ul><p>注意需求第三点中要求的路由汇聚在1.12中体现，只有在修复DMVPN之后，DC中才会有<code>10.6.0.0/15</code>网段的路由。</p><h1 id="1-9-BGP-between-HQ-DC-and-service-provides"><a href="#1-9-BGP-between-HQ-DC-and-service-provides" class="headerlink" title="1.9 BGP between HQ-DC and service provides"></a>1.9 BGP between HQ-DC and service provides</h1><p>考题如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Configure the BGP peering between HQ&#x2F;DC and global SP#1 and Global SP#2 according to these requirements：</span><br><span class="line"></span><br><span class="line">1. Bring up the BGP peering between HQ r11 and SP1 r23</span><br><span class="line"></span><br><span class="line">2. Bring up the BGP peering between DC r21 and SP1 r23</span><br><span class="line"></span><br><span class="line">3. Bring up the BGP pering DC r22 and SP2</span><br><span class="line"></span><br><span class="line">4. Ensure that the routes learned over eBGP sessions and further advertised in iBGP will be considered reachable even if the networks on inter-AS links are not advertised in OSPF. The configuration of this requirement must be completed exclusively with the &quot;router bgp&quot; context</span><br><span class="line"></span><br><span class="line">5. On r11，r21，r22 perform mutual redistribution between OSPFv2 and BGP. Howevr, prevent routes that were injected into OSPF from BGP to be reinjected back into BGP. This requirement must be solved on r11,r21,r22 using only a single route0map on each of the routes andwithout any reference to ACLs,prefix lists or route-types</span><br><span class="line"></span><br><span class="line">6. Prevent HQ and DC from ever communicating through SP1 r3. All communication between HQ and DC must occur only over the direct sw101&#x2F;sw201 and sw102&#x2F;sw202 interconnections. Any other communication must remain unaffected. This requirement must be solved on r11,r21 and r22 by route filtering based on a well-known mandatory attribute without the use of routemaps.</span><br><span class="line"></span><br><span class="line">7. No command may be removed from configuration on r11 to accomplish this entire task</span><br><span class="line"></span><br><span class="line">8. It is allowed to modify existing configuration commands inside router bgp 65002 on r21 and r22 to accomplish this entire task.</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>1.9的拓扑示意图如下：</p><p><img src="https://rancho333.github.io/pictures/lab_1.9.png"></p><p>总共涉及到5台设备，其中sp1的r3和sp2都是预配好的，不需要动，只需要在r11,r21和r22三台设备进行配置。配置思路如下：</p><p>先完成BGP邻居的建立</p><ul><li>配置r11，使其与r3建立eBGP</li><li>配置r21，使其与r3建立eBGP，使其与r22建立iBGP，并且下一跳为自身</li><li>配置r22，使其与sp2建立eBGP邻居； 使其与r21建立iBGP，并且下一跳为自身</li></ul><p>然后做双点双向重分布以及as-path</p><ul><li>r11上将bgp路由重分布进ospf，打上tag，创建route-map拒绝该tag</li><li>在r11上创建as-path拒绝65002的路由，并在bgp邻居中应用</li><li>在r11上将ospf的路由重分布进bgp，并应用route-map</li><li>在r21和r22上重复上述操作</li></ul><p>简要说明下拓扑，R11和R21处于两个路由域的边界，上方是ospf，下方是BGP，这就是一个典型的双点双向重分布环境。</p><ul><li>r3的bgp路由发布给R11, 然后被引入ospf域，r21通过ospf学到，重分布进bgp，又发布给r3，这样会形成路由环路</li><li>r21将ospf域内的路由重发布进bgp，r11上通过bgp学到该路由，bgp AD比ospf小，所以r11会通过bgp到达r21，而不是之前的ospf，这样形成次优路径</li></ul><p>关于双点双向充分布的分析可以参考这篇 <a href="https://rancho333.github.io/2022/07/12/%E5%8F%8C%E7%82%B9%E5%8F%8C%E5%90%91%E9%87%8D%E5%88%86%E5%B8%83/">blog</a>。</p><p>下面是解法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">建立eBGP，iBGP邻居</span><br><span class="line">r11:</span><br><span class="line">    router bgp 65001</span><br><span class="line">        bgp router-id 10.1.255.11           &#x2F;&#x2F; 手动配置bgp router-id</span><br><span class="line">        no bgp default ipv4-unicast         &#x2F;&#x2F; 默认配置不激活ipv4单播邻居</span><br><span class="line">        neighbor 100.3.11.1 remote-as 10000 </span><br><span class="line">    address-family ipv4</span><br><span class="line">        neighbor 100.3.11.1 active          &#x2F;&#x2F; 在ipv4地址族下手动激活邻居</span><br><span class="line"></span><br><span class="line">r21:</span><br><span class="line">    router bgp 65002</span><br><span class="line">        bgp router-id 10.2.255.21</span><br><span class="line">        no bgp default ipv4-unicast</span><br><span class="line">        neighbor 100.3.21.1 remote-as 10000</span><br><span class="line">    address-family ipv4</span><br><span class="line">        neighbor 100.3.21.1 active</span><br><span class="line">        neighbor 10.2.255.22 active         &#x2F;&#x2F; 预配已经指定as，激活即可</span><br><span class="line">        neighbor 10.2.255.22 next-hop-self   &#x2F;&#x2F; iBGP指定下一跳是自我</span><br><span class="line"></span><br><span class="line">r22：</span><br><span class="line">    router bgp 65002</span><br><span class="line">        bgp router-id 10.2.255.22</span><br><span class="line">        no bgp default ipv4-unicast</span><br><span class="line">        neighbor 101.22.0.1 remote-as 10001</span><br><span class="line">    address-family ipv4 </span><br><span class="line">        neighbor 101.22.0.1 active</span><br><span class="line">        neighbor 10.2.255.21 active         &#x2F;&#x2F; 同r21</span><br><span class="line">        neighbor 10.2.255.21 next-hop-self  </span><br></pre></td></tr></table></figure><p>配置完成之后，正常建立bgp邻居关系：<br><img src="https://rancho333.github.io/pictures/lab_1.9_bgp_neighbor.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">按要求配置路由策略：</span><br><span class="line"></span><br><span class="line">r11：</span><br><span class="line">router ospf 1</span><br><span class="line">    redistribute bgp 65001 subnets tag 123          &#x2F;&#x2F; 在ospf中引入bgp的路由，打上tag</span><br><span class="line"></span><br><span class="line">route-map O2B deny 10</span><br><span class="line">    match tag 123</span><br><span class="line">route-map O2B permit 20                &#x2F;&#x2F; 基于tag做路由策略，拒绝有tag 123的路由</span><br><span class="line"></span><br><span class="line">ip as-path access-list 100 deny _65002$     &#x2F;&#x2F; 配置基于as-patch的ACL，拒绝通过bgp接收65002的路由</span><br><span class="line">ip as-path access-list  100 permit .*       &#x2F;&#x2F; 允许除65002之外的路由</span><br><span class="line"></span><br><span class="line">router bgp 65001</span><br><span class="line">    address family ipv4</span><br><span class="line">        redistribute ospf 1 match internal external 1 external 2 route-map O2B &#x2F;&#x2F; 在bgp中引入ospf路由，包含ospf外部路由，调用路由策略拒绝tag路由</span><br><span class="line">        neighbor 100.3.11.1 filter-list 100 in          &#x2F;&#x2F; 针对eBGP调用ACL</span><br><span class="line"></span><br><span class="line">r22和r23上使用相同配置，注意下as number和 eBGP邻居地址即可</span><br><span class="line"></span><br><span class="line">clear ip bgp * soft include     &#x2F;&#x2F; 重置BGP路由表，使配置的策略生效</span><br></pre></td></tr></table></figure><p>查看r11上的路由表, <code>10.2</code>即DC区域的路由都是通过ospf学到的，并且是<code>O IA</code>类型，DC是area 0，HQ是area 1。<code>10.6</code>，<code>10.7</code>网段的路由则是通过BGP学到的，注意这需要配置完后面的DMVPN才能看到。<br><img src="https://rancho333.github.io/pictures/lab_1.9_r11_route.png"></p><p>对于r21和r22, <code>10.1</code>网段的路由也是通过ospf学到的。<br><img src="https://rancho333.github.io/pictures/lab_1.9_r21_r22_route.png"></p><p>HQ和DC中的路由通过bgp通告给r3. SP1在这里起到一个连接的作用，后续HQ和br3,4之间的互通都要通过这里，一定要保证双方的路由都传递过去了。<br><img src="https://rancho333.github.io/pictures/lab_1.9_r3_route.png"></p>]]></content:encoded>
      
      
      
      <category domain="https://rancho333.github.io/tags/CCIE/">CCIE</category>
      
      
      <comments>https://rancho333.github.io/2023/06/29/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.8%E4%B8%8E1.9/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>lab考题分析1.6与1.7</title>
      <link>https://rancho333.github.io/2023/06/28/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.6%E4%B8%8E1.7/</link>
      <guid>https://rancho333.github.io/2023/06/28/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.6%E4%B8%8E1.7/</guid>
      <pubDate>Wed, 28 Jun 2023 07:51:16 GMT</pubDate>
      
      <description>&lt;p&gt;继续考题分析，1.6与1.7。 这两题是ipv6相关，很简单。&lt;/p&gt;</description>
      
      
      
      <content:encoded><![CDATA[<p>继续考题分析，1.6与1.7。 这两题是ipv6相关，很简单。</p><span id="more"></span><h1 id="1-6-IPv6-in-HQ"><a href="#1-6-IPv6-in-HQ" class="headerlink" title="1.6 IPv6 in HQ"></a>1.6 IPv6 in HQ</h1><p>下面是考题。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Implement IPv6 on sw101 and sw102 for switch virtual interface(SVIs) vlan2000 and vlan2001 according to these requirements：</span><br><span class="line"></span><br><span class="line">sw101:</span><br><span class="line">    interface vlan2000: 2001:db8:1:100::1&#x2F;64</span><br><span class="line">    interface vlan2001: 2001:db8:1:101::1&#x2F;64</span><br><span class="line"></span><br><span class="line">sw102:</span><br><span class="line">    interface vlan2000: 2001:db8:1:100::2&#x2F;64</span><br><span class="line">    interface vlan2001: 2001:db8:1:101::2&#x2F;64</span><br><span class="line"></span><br><span class="line">The configuration must enable hosts in these Vlans to obtain their IPv6 configuration via SLAAC and keep a stable connectivity with their IPv6 networks.</span><br><span class="line"></span><br><span class="line">Use native IPv6 means to provide gateway redundancy, with sw101 being the preferred gateway in vlan2000 and sw102 being the preferred gateway in vlan2001. The role must be determined by explicit configuration on their intended preferred gateway.</span><br><span class="line"></span><br><span class="line">Hosts must be able to detect the preferred gateway in as little as 3 seconds.</span><br></pre></td></tr></table></figure><p>1.6的拓扑示意图如下：</p><p><img src="https://rancho333.github.io/pictures/lab_1.6.png"></p><p>和1.3一样，只涉及到sw101和sw102这两台交换机，配置很简单，就是在SVI上配置ipv6地址，再做RA一些属性配置即可. 配置如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ipv6 unicast-routing        &#x2F;&#x2F; 确保开启ipv6单播功能，这样RA通告才可以发送，客户端才可以通过SLAAC无状态获取ipv6地址</span><br><span class="line"></span><br><span class="line">sw101:</span><br><span class="line">    inter vlan2000 </span><br><span class="line">        ipv6 addr 2001:db8:1:100::1&#x2F;64</span><br><span class="line">        ipv6 nd ra internal msec 2000</span><br><span class="line">        ipv6 nd ra lifetime 3</span><br><span class="line">        ipv6 nd router-preference High</span><br><span class="line">    inter vlan2001 </span><br><span class="line">        ipv6 addr 2001:db8:1:101::1&#x2F;64</span><br><span class="line">        ipv6 nd ra internal msec 2000</span><br><span class="line">        ipv6 nd ra lifetime 3</span><br><span class="line">sw102:</span><br><span class="line">    inter vlan2000 </span><br><span class="line">        ipv6 addr 2001:db8:1:100::2&#x2F;64</span><br><span class="line">        ipv6 nd ra internal msec 2000</span><br><span class="line">        ipv6 nd ra lifetime 3</span><br><span class="line">    inter vlan2001 </span><br><span class="line">        ipv6 addr 2001:db8:1:101::2&#x2F;64</span><br><span class="line">        ipv6 nd ra internal msec 2000</span><br><span class="line">        ipv6 nd ra lifetime 3</span><br><span class="line">        ipv6 nd router-preference High</span><br><span class="line">&#x2F;&#x2F; 先配置RA通告间隔，在配置RA产生默认路由的生命周期，否则会报错</span><br><span class="line">&#x2F;&#x2F; RA的lifetime时间不应该小于RA通告时间</span><br></pre></td></tr></table></figure><p>保证对应vlan配置<code>High</code>即可，试验台上主机上貌似看不到现象；或者在sw110上创建svi来模拟。<br>在主机上通过<code>ifconfig</code>查看ipv6地址，<code>ip -6 route</code>查看路由，检查网关优先级。</p><p><img src="https://rancho333.github.io/pictures/lab_1.6_ipv6.png"></p><h1 id="1-7-Ipv6-Eigrp-in-HQ"><a href="#1-7-Ipv6-Eigrp-in-HQ" class="headerlink" title="1.7 Ipv6 Eigrp in HQ"></a>1.7 Ipv6 Eigrp in HQ</h1><p>下面是题目。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">In HQ enable EIGRP for ipv6 on r11,r12,sw101 and sw102 according to these requirements:</span><br><span class="line"></span><br><span class="line">1. Use process name &quot;ccie&quot; (without the quotes) and AS number 65001</span><br><span class="line"></span><br><span class="line">2. Do not configure any additional IPv6 addresses</span><br><span class="line"></span><br><span class="line">3. IPv6 EIGRP may form adjacencies only over the physical Layer3 interface between r11,r12,sw101 and sw102</span><br><span class="line"></span><br><span class="line">4. Prevent IPv6 EIGRP from automatically running on, or advertising attached prefixes from new ipv6-enabled interfaces in the future unless allowed explicitly</span><br><span class="line"></span><br><span class="line">5. Ensure that the attached ipv6 prefixes on SVI‘s vlan2000 and vlan2001 on sw101 and sw102 are advertised in ip6 EIGRP and learned on r11 and r12</span><br><span class="line"></span><br><span class="line">6. No route filtering is allowed to accomplish this entire task</span><br></pre></td></tr></table></figure><p>1.7的拓扑示意示意如下：</p><p><img src="https://rancho333.github.io/pictures/lab_1.7.png"></p><p>总共涉及到四台设备，分别是sw101,sw102,r11和r12。 基本思路如下：</p><ul><li>将eigrp接口默认行为改为passive和shutdown</li><li>只在物理三层接口上开启eigrp邻居</li><li>sw101和sw102的svi，r11和r12的loopback只通告路由，不建立eigrp邻居</li></ul><p>配置如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">ipv6 unicast-routing            &#x2F;&#x2F; 先全局开启ipv6单播功能，否则无法启动eigrp的ipv6</span><br><span class="line"></span><br><span class="line">sw101&#x2F;sw102:</span><br><span class="line">    router eigrp ccie</span><br><span class="line">    address-family ipv6 unicat autonomous-system 65001        &#x2F;&#x2F; 创建eigrp实例ccie，as为65001</span><br><span class="line">    af-interface default</span><br><span class="line">        shutdown</span><br><span class="line">        passive-interface        &#x2F;&#x2F; 所有ipv6接口不宣告进eigrp，并且默认全为被动接口</span><br><span class="line">    af-interface gi0&#x2F;0</span><br><span class="line">        no shutdown</span><br><span class="line">        no passive-interface</span><br><span class="line">    af-interface e0&#x2F;1</span><br><span class="line">        no shutdown</span><br><span class="line">        no passive-interface        &#x2F;&#x2F; 与r11和r12互联的三层接口打开ipv6 eigrp</span><br><span class="line">    af-interface vlan2000</span><br><span class="line">        no shutdown</span><br><span class="line">    af-interface vlan2001</span><br><span class="line">        no shutdown            &#x2F;&#x2F; 末节svi没有必要建立eigrp邻居，但所在网段需要通过eigrp传递路由</span><br><span class="line"></span><br><span class="line">r11&#x2F;r12:</span><br><span class="line">router eigrp ccie</span><br><span class="line">        address-family ipv6 unicast autonomous-system 65001</span><br><span class="line">        af-interface default</span><br><span class="line">            shutdown</span><br><span class="line">            passive-interface            &#x2F;&#x2F; 默认所有接口不宣告进eigrp，并且默认全为被动接口</span><br><span class="line">        af-interface e0&#x2F;1</span><br><span class="line">            no shutdown</span><br><span class="line">            no passive-interface</span><br><span class="line">        af-interface e0&#x2F;2</span><br><span class="line">            no shutdown</span><br><span class="line">            no passive-interface</span><br><span class="line">        af-interface e0&#x2F;3</span><br><span class="line">            no shutdown</span><br><span class="line">            no passive-interface            &#x2F;&#x2F; R11&amp;R12正常宣告三层物理接口进eigrp</span><br><span class="line">        af-interface loopback0</span><br><span class="line">            no shutdown                &#x2F;&#x2F; 环回口只需要no shutdown, 不用no passive</span><br><span class="line">            exit-af-interface</span><br></pre></td></tr></table></figure><p>配置完成之后，sw101和sw102应该各有两个ipv6 eigrp邻居,分别是r11和r12<br><img src="https://rancho333.github.io/pictures/lab_1.7_eigrp_neighbor_1.png"></p><p>r11和r12各有三个eigrp邻居，分别是sw101,sw102与r11/12<br><img src="https://rancho333.github.io/pictures/lab_1.7_eigrp_neighbor_2.png"></p><p>r11，r12上对于sw101和sw102的SVI ipv6网段路由应用是ECMP：<br><img src="https://rancho333.github.io/pictures/lab_1.7_eigrp_ecmp.png"></p><p>在主机上对r11或r12的lo0 ipv6地址进行traceroute测试，host11应该优先走sw101, 挂了后则走sw102。host12同理。这里就只做一个ping测试了。<br><img src="https://rancho333.github.io/pictures/lab_1.7_eigrp_ping.png"></p>]]></content:encoded>
      
      
      
      <category domain="https://rancho333.github.io/tags/CCIE/">CCIE</category>
      
      
      <comments>https://rancho333.github.io/2023/06/28/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.6%E4%B8%8E1.7/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>lab考题分析1.5</title>
      <link>https://rancho333.github.io/2023/06/21/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.5/</link>
      <guid>https://rancho333.github.io/2023/06/21/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.5/</guid>
      <pubDate>Wed, 21 Jun 2023 08:58:18 GMT</pubDate>
      
      <description>&lt;p&gt;继续考题分析，1.5&lt;/p&gt;</description>
      
      
      
      <content:encoded><![CDATA[<p>继续考题分析，1.5</p><span id="more"></span><h1 id="1-5-DHCP-ipv4-service-for-HQ"><a href="#1-5-DHCP-ipv4-service-for-HQ" class="headerlink" title="1.5 DHCP ipv4 service for HQ"></a>1.5 DHCP ipv4 service for HQ</h1><p>下面是考题：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Enable hosts in HQ vlan2000 and vlan2001 to obtain their IP configuration via DHCP according to these requirements.</span><br><span class="line"></span><br><span class="line">1. On sw211,create ipv4 DHCP pools name hq_v2000 and hq_v2001 for HQ vlans 2000 and 2001 respectively. In each subnet assign addresses from .101 up to .254 inclusively and the appropriate gateway to clients.</span><br><span class="line"></span><br><span class="line">2. In addition to this make sure host11 get ip address 10.1.100.150 and host12 ge ip address 10.1.101.150</span><br><span class="line"></span><br><span class="line">3. Enable DHCP snooping on sw110 in vlans 2000 and 2001 to protect against DHCP related attacks。ALso apply rate limit on edge devices &quot;15 packets per second&quot; and unlimited at the switches(portchannel)</span><br><span class="line"></span><br><span class="line">4. Place host11 into vlan2000; Pleace host12 into vlan2001</span><br><span class="line"></span><br><span class="line">5. Perform the necessary configuration on switches sw101, sw102, sw110 to enable hosts in vlans 2000 and 2001 to obtain ipv4 configuration through DHCP. The DHCP server running at sw211 in the DC must be referred to by its ipv4 address 10.2.255.211. Do not disable the option 82 insertion，and do not enable DHCP snooping on other switches。</span><br><span class="line"></span><br><span class="line">6. Verify that host11 and host12 have the IP connectivity to the Cisco DNA center,vManage, ISE running in the DC using their internal(in Band connectivity) address</span><br></pre></td></tr></table></figure><p>1.5的拓扑示意如下：<br><img src="https://rancho333.github.io/pictures/lab_1.5.png"></p><p>涉及到6台设备，分别是host11,host12,sw110,sw101,sw102,sw211.<br>1.2,1.3,1.4都是为了1.5做铺垫，1.2是打通二层链路，1.3是配置冗余网关，1.4是解决主机，网关到DHCP server的路由。1.6就是做DHCP配置，使host11，host12拿到ip。基本思路如下：</p><ul><li>sw211作为dhcp server，分别给HQ的vlan2000,vlan2001配置dhcp pool，并添加relay信任</li><li>sw101和sw102上面做dhcp relay配置并添加relay信任</li><li>sw110上做dhcp snooping相关配置</li><li>host11和host12通过dhcp获取ip</li><li>通过client-id给指定设备分配固定ip</li></ul><ol><li><p>配置DHCP server</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sw211：</span><br><span class="line">    ip dhcp pool hq_v2000</span><br><span class="line">        network 10.1.100.0 &#x2F;24</span><br><span class="line">        default-router 10.1.100.1</span><br><span class="line">    ip dhcp pool hq_v2001</span><br><span class="line">        network 10.1.101.0 &#x2F;24</span><br><span class="line">        default-router 10.1.101.1     &#x2F;&#x2F; 配置地址池</span><br><span class="line">    ip dhcp exclude-address 10.1.100.0 10.1.100.100</span><br><span class="line">    ip dhcp exclude-address 10.1.101.0 10.1.101.100     &#x2F;&#x2F; 预留地址，从101开始分配</span><br><span class="line">    ip dhcp relay information trust-all                 &#x2F;&#x2F; sw101&#x2F;102中继后，option82里面不应该有内容了吗                </span><br></pre></td></tr></table></figure></li><li><p>配置DHCP relay</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sw101&#x2F;sw102:</span><br><span class="line">    int ran vlan 2000-2001</span><br><span class="line">        ip helper-address 10.2.255.211</span><br><span class="line">    ip dhcp relay information trust-all         &#x2F;&#x2F; 全局开启，信任sw110嗅探后插入的option82为空的dhcp报文</span><br><span class="line">    &#x2F;&#x2F; 经过relay的dhcp报文，会插入option82字段，表明设备所在的物理位置，从而让DHCP从对应的地址池分配ip</span><br></pre></td></tr></table></figure><p>配置结果如下：</p></li></ol><p><img src="https://rancho333.github.io/pictures/lab_1.5_dhcp_relay.png"></p><ol start="3"><li>配置DHCP snooping相关<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sw110：</span><br><span class="line">    ip dhcp snooping        &#x2F;&#x2F; 首先开启全局dhcp嗅探</span><br><span class="line">    ip dhcp snooping vlan 2000-2001         &#x2F;&#x2F; 指定dhcp嗅探的vlan</span><br><span class="line">    ip dhcp snooping information option        &#x2F;&#x2F; 嗅探后的DHCP报文插入option82字段，表明该dhcp报文被嗅探过(默认是开启的),但是option82中是无效ip 0.0.0.0</span><br><span class="line"></span><br><span class="line">    inter gi0&#x2F;0</span><br><span class="line">        switchport mode access</span><br><span class="line">        switchport access vlan 2000</span><br><span class="line">        ip dhcp snooping limit rate 15</span><br><span class="line">    inter gi0&#x2F;1</span><br><span class="line">        switchport mode access</span><br><span class="line">        switchport access vlan 2001</span><br><span class="line">        ip dhcp snooping limit rate 15      &#x2F;&#x2F; 将接口加入指定vlan，并限制dhcp报文速度</span><br><span class="line">    inter range port-c 1-2</span><br><span class="line">        ip dhcp snooping trust          &#x2F;&#x2F; 信任上行链路dhcp，不做限制</span><br></pre></td></tr></table></figure>dhcp snooping配置结果现象如下：</li></ol><p><img src="https://rancho333.github.io/pictures/lab_1.5_dhcp_snooping.png"></p><ol start="4"><li>主机获取ip<br>之后使host11和host12通过dhcp获取ip，结果如下：</li></ol><p><img src="https://rancho333.github.io/pictures/lab_1.5_dhcp.png"></p><p>host12上误操作多次获取ip，正确结果应该是10.1.101.101, 重启host12结果即可正常，这里不操作了。</p><ol start="5"><li>指定固定ip<br>将client-id与ip地址进行绑定，从而给主机分配指定ip，client-id是<code>01</code>加mac地址组成的，配置如下：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ip dhcp client client-id gi0&#x2F;1          &#x2F;&#x2F; 如果client-id过长，使用该命令指定client-id格式，linux主机不需要配置</span><br><span class="line"></span><br><span class="line">sw211:</span><br><span class="line">    show ip dhcp binding        &#x2F;&#x2F; 查看dhcp分配</span><br><span class="line">    clear ip dhcp binding *     &#x2F;&#x2F; 清除分配信息</span><br><span class="line"></span><br><span class="line">    ip dhcp pool hq_v2000</span><br><span class="line">        address 10.1.100.150 client-id xx</span><br><span class="line">    ip dhcp pool hq_v2001</span><br><span class="line">        address 10.1.101.150 client-id xx       &#x2F;&#x2F; 地址绑定</span><br></pre></td></tr></table></figure>使host重新获取ip地址，结果如下；<br><img src="https://rancho333.github.io/pictures/lab_1.5_dhcp_client-id.png"></li></ol><p>注意state的状态是<code>Active</code>，如果server上看不到分配的ip，说明主机报文无法到达server，如果state状态是<code>Selecting</code>，表明主机没有收到server的offer报文，server到主机方向的路由有问题。</p><p>host获取到指定ip，最后测试host到DC中几个关键服务器的可达性：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">host11&#x2F;12:</span><br><span class="line">    ping 10.2.250.11</span><br><span class="line">    ping 10.2.251.11</span><br><span class="line">    ping 10.2.252.11    </span><br><span class="line">    ping 10.2.253.11</span><br><span class="line">    ping 10.2.254.11</span><br></pre></td></tr></table></figure><p>lab考试中有两个DHCP服务器，一个是sw211，另外一个是r23。r23只是给br1和br2的guest vpn提供DHCP服务，而sw211则给HQ中的host11,host12; br3中的host61，host62, br4中的host71,host72; br1/2中的IoT vpn、Employee vpn提供dhcp服务。我们可以在1.5中将sw211上的DHCP pool都配置掉。</p>]]></content:encoded>
      
      
      
      <category domain="https://rancho333.github.io/tags/CCIE/">CCIE</category>
      
      
      <comments>https://rancho333.github.io/2023/06/21/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.5/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>lab考题分析1.3与1.4</title>
      <link>https://rancho333.github.io/2023/06/20/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.3%E4%B8%8E1.4/</link>
      <guid>https://rancho333.github.io/2023/06/20/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.3%E4%B8%8E1.4/</guid>
      <pubDate>Tue, 20 Jun 2023 07:44:57 GMT</pubDate>
      
      <description>&lt;p&gt;继续考题分析，1.3和1.4。&lt;/p&gt;</description>
      
      
      
      <content:encoded><![CDATA[<p>继续考题分析，1.3和1.4。</p><span id="more"></span><h1 id="1-3-First-hop-redundancy-protocol-in-HQ"><a href="#1-3-First-hop-redundancy-protocol-in-HQ" class="headerlink" title="1.3 First hop redundancy protocol in HQ"></a>1.3 First hop redundancy protocol in HQ</h1><p>下面是考题</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">For ipv4, implement an FHRP mechanism on sw101 and sw102 for vlans 2000 and vlan 2001 according to these requiremnet:</span><br><span class="line"></span><br><span class="line">1. Use group number 100 for vlan 2000 and group number 101 for vlan 2001</span><br><span class="line"></span><br><span class="line">2. Use the first available ipv4 address in the subnet for the address of the virtual router</span><br><span class="line"></span><br><span class="line">3. For vlan2000, sw101 must be the preferred gateway，for vlan2001，sw102 must be the preferred gateway. Do not rely on the ipv4 addresses of the switches as role tiebreakers. The role must be determined and explicit configuration on the intended preferred gateway.</span><br><span class="line"></span><br><span class="line">4. Each preferred gateway must monitor the reachability of both routers r11 and r12 using the loopback ipv4 addresses of the routers by icmp echo. The reachability is to be verified every 5 seconds with a timeout of 400 msec. A router must be declared unreachable as soon as it does not respond to three probes in a row. If both r11 and r12 are declared unreachable from a preferred gateway，the other switch must be allow to assume the gateway role, only a single tracking command may be added to the appropriate SVI configuration to accomplish this requirement</span><br><span class="line"></span><br><span class="line">5. Use the FHRP protocol that allows the virtual ipv4 address to match the ipv4 addresses of a member router</span><br></pre></td></tr></table></figure><p>1.3的拓扑示意如下：</p><p><img src="https://rancho333.github.io/pictures/lab_1.3.png"></p><p>涉及到4台设备，但是只用配置sw101和sw102这两台设备，基本思路：</p><ul><li>配置vrrp，使sw101成为vlan2000的active，使sw102成为vlan2001的active</li><li>配置ip sla和track，作用在active的SVI上</li></ul><ol><li>配置vrrp<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sw101</span><br><span class="line">inter vlan2000</span><br><span class="line">    vrrp 100 ip 10.1.100.1</span><br><span class="line">    vrrp 100 priority 105</span><br><span class="line">inter vlan2001</span><br><span class="line">    vrrp 101 ip 10.1.101.1</span><br><span class="line">sw102：</span><br><span class="line">inter vlan2000</span><br><span class="line">    vrrp 100 ip 10.1.100.1</span><br><span class="line">inter vlan2001</span><br><span class="line">    vrrp 101 ip 10.1.101.1</span><br><span class="line">    vrrp 101 priority 105</span><br></pre></td></tr></table></figure>配置完成后，验证sw101和sw102互为主备：</li></ol><p><img src="https://rancho333.github.io/pictures/lab_1.3_vrrp.png"></p><ol start="2"><li>配置ip sla和track<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">sw101&#x2F;sw102</span><br><span class="line">ip sla 11</span><br><span class="line">    icmp-echo 10.1.255.11         &#x2F;&#x2F; track r11的可达性</span><br><span class="line">    frequency 5</span><br><span class="line">    threshold 80</span><br><span class="line">    timeout 400</span><br><span class="line">ip sla 12</span><br><span class="line">    icmp-echo 10.1.255.12       &#x2F;&#x2F; track r12的可达性</span><br><span class="line">    frequency 5</span><br><span class="line">    threshold 80</span><br><span class="line">    timeout 400</span><br><span class="line">ip sla schedule 11 start-time now life forever</span><br><span class="line">ip sla schedule 12 start-time now life forever</span><br><span class="line">track 1 ip sla reachability</span><br><span class="line">    delay down 10</span><br><span class="line">track 2 ip sla reachability</span><br><span class="line">    delay down 10</span><br><span class="line">track 3 list boolean or</span><br><span class="line">    object 1</span><br><span class="line">    object 2</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 分别在两个active的gateway下添加track</span><br><span class="line">sw101:</span><br><span class="line">interface vlan2000             </span><br><span class="line">    vrrp 100 track 3 decrement 15</span><br><span class="line">sw102：</span><br><span class="line">interface vlan2001</span><br><span class="line">    vrrp 101 track 3 decrement 15</span><br></pre></td></tr></table></figure>配置完成之后验证：</li></ol><p><img src="https://rancho333.github.io/pictures/lab_1.3_sla.png"></p><p><img src="https://rancho333.github.io/pictures/lab_1.3_track.png"></p><p>验证vrrp与track的联动：<br>将r11和r12的lo0 shutdown，sw101和sw102上vrrp原本active的优先级将为90, 100的成为新的active<br><img src="https://rancho333.github.io/pictures/lab_1.3_track_verify.png"></p><h1 id="1-4-Ospfv2-between-HQ-and-DC"><a href="#1-4-Ospfv2-between-HQ-and-DC" class="headerlink" title="1.4 Ospfv2 between HQ and DC"></a>1.4 Ospfv2 between HQ and DC</h1><p>下面是考题。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Complete and correct the ospf configuration on the switches sw101,sw102,sw201 and sw202 according to these requirements.</span><br><span class="line"></span><br><span class="line">1. Enable ospfv2 on the redundant interconnections between the DC and HQ sites. Make sure that ospf establishes adjacencies on these interconnection and exchange routing information between the DC and HQ sites.</span><br><span class="line"></span><br><span class="line">2. HQ must be configured in ospf area 1 and DC in ospf area 0</span><br><span class="line"></span><br><span class="line">3. The primary traffic path must be the link between sw101&amp;sw201 and the link between sw102&amp;sw202 must become primary path during primary link failover。 For achieving this requirement you are not allowed to configure on sw201&amp;sw202</span><br><span class="line"></span><br><span class="line">4. All DC ospf speakers must see 10.1.0.0&#x2F;16 for any HQ subnets</span><br><span class="line"></span><br><span class="line">5. Protect the authenticity and integrity of the ospfv2 sessions on the redundant interconnections between DC and HQ with the SHA-384 mechanism. Use key ID 1 and a shared secret of &quot;cci3&quot;（without quotes）</span><br><span class="line"></span><br><span class="line">6. Improve the detection of unreachable ospfv2 neighbors on the redundant interconnections between DC and HQ that ospf can detect the losses of a neighbor with 300 msec, eith the probes being sent every 100 msec. It is not allowed to modify ospf timers to accomplish this requirements.</span><br></pre></td></tr></table></figure><p>1.4的拓扑图如下所示：</p><p><img src="https://rancho333.github.io/pictures/lab_1.4.png"></p><p>总共涉及到6台设备，其中r11和r12在are 1中，sw201和sw202在area 0中，sw101和sw102作为ABR。配置思路如下：</p><ul><li>sw101和sw102上将vlan2000和vlan2001，它们作为末节路由器的主机网关，配置为passive if, 只通告路由而不参与ospf邻居建立</li><li>根据所在区域，将6台路由器相应的接口加入到对应的ospf区域，并在sw202上取消错误的passive if配置</li><li>在sw101,sw102,sw201,sw202四台交换机上配置key chain, 作为接口安全认证; 创建bfd邻居，减少ospf收敛时间</li><li>路由规划，创建virtual link以及配置接口ospf cost</li></ul><p>解法配置如下：</p><ol><li><p>配置passive if</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sw101&amp;sw102：</span><br><span class="line">router ospf 1</span><br><span class="line">    passive-interface vlan2000</span><br><span class="line">    passive-interface vlan2001</span><br></pre></td></tr></table></figure></li><li><p>建立ospf邻居</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sw101&amp;sw102:</span><br><span class="line">int range gi0&#x2F;0-1,vlan2000-2001,lo0         &#x2F;&#x2F; 默认都在area 0中，考场上check下与sw201,sw201接口的配置(确保在area 0中)</span><br><span class="line">    ip ospf 1 area 1</span><br><span class="line"></span><br><span class="line">r11&amp;r12:</span><br><span class="line">int range gi0&#x2F;1-3，lo0</span><br><span class="line">    ip ospf 1 area 1</span><br><span class="line"></span><br><span class="line">sw202:</span><br><span class="line">router ospf 1</span><br><span class="line">    no passive-interface gi1&#x2F;2          &#x2F;&#x2F; 考场上注意下sw201的对应配置</span><br></pre></td></tr></table></figure></li><li><p>配置key chain 与 bfd</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sw101&amp;sw102&amp;sw201&amp;sw202：</span><br><span class="line">key chain cisco</span><br><span class="line">    key 1</span><br><span class="line">        key string cci3</span><br><span class="line">        cryptographic-algorithm hmac-sha-384     </span><br><span class="line">interface gi 0&#x2F;2  1&#x2F;2:</span><br><span class="line">    ip ospf authentication key-chain cisco</span><br><span class="line">    ip ospf bfd                             &#x2F;&#x2F; 使能接口bfd功能</span><br><span class="line">    bfd internal 100 min_rx 100 multiplier  &#x2F;&#x2F; 根据要求配置bfd参数</span><br></pre></td></tr></table></figure><p>接口下的key chain配置必须一模一样，否则会导致ospf邻居down掉。配置完成后检查bfd邻居状态：</p></li></ol><p><img src="https://rancho333.github.io/pictures/lab_1.4_bfd.png"></p><ol start="4"><li>路由规划<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sw101：</span><br><span class="line">router ospf 1</span><br><span class="line">    area 1 virtual-link 10.1.255.102        &#x2F;&#x2F; 与sw102建立v-link</span><br><span class="line">    area 1 range 10.1.0.0 255.255.0.0       &#x2F;&#x2F; 路由汇聚</span><br><span class="line"></span><br><span class="line">sw102:</span><br><span class="line">router ospf 1</span><br><span class="line">    area 1 virtual-link 10.1.255.102        &#x2F;&#x2F; 与sw102建立v-link，这样可以从sw101接收到从area 0发送来的路由</span><br><span class="line">    area 1 range 10.1.0.0 255.255.0.0  cost 200    &#x2F;&#x2F; 增加宣告给sw202的汇聚路由的cost，使sw202从sw201访问HQ</span><br><span class="line">    interface gi 0&#x2F;2</span><br><span class="line">        ip ospf cost 200       &#x2F;&#x2F; 增大接口ospf的cost，使sw102访问DC的流量走sw101</span><br></pre></td></tr></table></figure></li></ol><p>配置完成之后，检查ospf邻居状态：</p><p><img src="https://rancho333.github.io/pictures/lab_1.4_ospf.png"></p><p>sw101与sw102上面有四个邻居，r11与r12上有3个邻居。</p><p>检查路由规划效果，sw102通过sw101到DC，注意sw102可以ecmp r11和r12到达sw101, 所以有两个下一跳。</p><p><img src="https://rancho333.github.io/pictures/lab_1.4_ospf_route.png"></p><p>对于sw202，通过sw101到达HQ。</p><p><img src="https://rancho333.github.io/pictures/lab_1.4_ospf_route_2.png"></p>]]></content:encoded>
      
      
      
      <category domain="https://rancho333.github.io/tags/CCIE/">CCIE</category>
      
      
      <comments>https://rancho333.github.io/2023/06/20/lab%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.3%E4%B8%8E1.4/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>lab考试基本介绍及考题分析</title>
      <link>https://rancho333.github.io/2023/06/19/lab%E8%80%83%E8%AF%95%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D%E5%8F%8A%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.2/</link>
      <guid>https://rancho333.github.io/2023/06/19/lab%E8%80%83%E8%AF%95%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D%E5%8F%8A%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.2/</guid>
      <pubDate>Mon, 19 Jun 2023 08:18:42 GMT</pubDate>
      
      <description>&lt;h1 id=&quot;lab基本介绍&quot;&gt;&lt;a href=&quot;#lab基本介绍&quot; class=&quot;headerlink&quot; title=&quot;lab基本介绍&quot;&gt;&lt;/a&gt;lab基本介绍&lt;/h1&gt;&lt;p&gt;在22年9月份考过CCNP(350-408)的笔试后就一直在约lab的考试，终于在今年(23)4月份约了一个北京考场的位置，5月初开始正式备考。EI CCIE lab考试总共分为两个部分，第一部分是design，全部是笔试，共计39题(第一题介绍，最后一题say goodby)，3小时内完成；第二部分是DOO(deploy，operate，optimize)，共计5小时。design做完可以提前交卷，3小时中剩下的时间则直接作废，不会加给DOO使用。DOO就是lab实操了，主要分为三块，一是传统网络，二是SDN网络，三是自动化。传统网络共计16个小题，SDN网络共计6个小题，自动化共计三个小题，每个部分中都有一个选择题。&lt;/p&gt;</description>
      
      
      
      <content:encoded><![CDATA[<h1 id="lab基本介绍"><a href="#lab基本介绍" class="headerlink" title="lab基本介绍"></a>lab基本介绍</h1><p>在22年9月份考过CCNP(350-408)的笔试后就一直在约lab的考试，终于在今年(23)4月份约了一个北京考场的位置，5月初开始正式备考。EI CCIE lab考试总共分为两个部分，第一部分是design，全部是笔试，共计39题(第一题介绍，最后一题say goodby)，3小时内完成；第二部分是DOO(deploy，operate，optimize)，共计5小时。design做完可以提前交卷，3小时中剩下的时间则直接作废，不会加给DOO使用。DOO就是lab实操了，主要分为三块，一是传统网络，二是SDN网络，三是自动化。传统网络共计16个小题，SDN网络共计6个小题，自动化共计三个小题，每个部分中都有一个选择题。</p><span id="more"></span><p>这个系列的blog主要用来对当前版本lab的网络做一个基本分析，注意在2023年9月之后lab会改版。</p><h1 id="lab-拓扑全景"><a href="#lab-拓扑全景" class="headerlink" title="lab 拓扑全景"></a>lab 拓扑全景</h1><p>整个lab的所有设备及连接如下图所示：</p><p><img src="https://rancho333.github.io/pictures/lab1.1_topology.drawio.png"></p><p>这个图实际上还是很复杂的，总共由10个sites组成，分别是：</p><ul><li>HQ(head quarter)：主要跑ospf, eigrp v6，bgp等，虽然r12和ISP互联，但是默认从DC访问互联网</li><li>DC(data center)：整个网络的中心，跑ospf, dmvpn，eigrp等，DHCP server, DMVPN hub, viptela，DNAc都部署在里面</li><li>IaaS(Infrastructure as a service) 主要用来做自动化，以及ping通R30的ipv6 loopback</li><li>ISP(Internet service provider) 提供8.8.8.8，并且会通过BGP下发默认路由</li><li>SP1(service provider 1) 主要跑mpls,bgp，起到连接各个sites的作用</li><li>SP2 同SP1，上面只跑BGP</li><li>Branch1 分支1，跑SDN，viptela的overlay是DNAc的underlay，viptela在vedge之间构建好vpn通道，DNAc基于此对物理交换机进行纳管，注意SW400是border/edge两种角色一体</li><li>Branch2 分支2，跑SDN，大部分同branch1, sw501和sw502是border角色，sw510是edge</li><li>Branch3 分支3，跑DMVPN，作为spoken</li><li>Branch4 分支4，跑DMVPN，作为spoken</li></ul><p>最终的目的其实很简单，就是使用L2，L3，SDN等网络技术使所有主机都获取到ip地址，并能访问ISP中的8.8.8.8(google DNS服务器)，当然，HQ,DC,IaaS，branch1,branch2,branch3,branch4之间也是互联互通的，即这些sites中的主机都可以ping通的，guest vpn除外。</p><h2 id="传统1-2"><a href="#传统1-2" class="headerlink" title="传统1.2"></a>传统1.2</h2><p>1.1是introduction，直接pass了。下面是1.2的题目。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">layer 2 technologies in HQ</span><br><span class="line"></span><br><span class="line">Complete and correct the etherchannel configuration between switches sw101,sw102,sw110 according to these requirements：</span><br><span class="line">1. At the end of the task，all ethernetchannels between switches sw101, sw102 must be up and operational including all their physical member links</span><br><span class="line">2. Do not create new port-channel interfaces; reuse that already exist on the switches</span><br><span class="line">3. When resolving existing issues，do not change the preconfigured negotiation protocol（if any）</span><br><span class="line">4. On ethernetchannel that use a negotiation protocol，tune its mode of operation for the shortest link bunding time possible</span><br><span class="line"></span><br><span class="line">Configure VTP version 3 on these switches as follows:</span><br><span class="line">1. VTP domain must be set to CCIE</span><br><span class="line">2. VTP password must be cc1E@fab</span><br><span class="line">3. When displayed, the VTP password must be shown as 32-character hexadecimal string</span><br><span class="line">4. sw101 must be configured as VTP server for the MST feature</span><br><span class="line">5. sw102 &amp; sw110 must be configured as VTP client for the MST feature</span><br><span class="line"></span><br><span class="line">These switches must run MST and maintain 3 instances including the default instance 0 as follows：</span><br><span class="line">1. Associate vlans 1001-2000 in instance 1</span><br><span class="line">2. Associate vlans 2001-4094 in instance 2</span><br><span class="line">3. sw101 must be root for the default instance 0 and instance 1</span><br><span class="line">4. sw102 must be root for instance 2</span><br></pre></td></tr></table></figure><p>1.2的拓扑示意如下：</p><p><img src="https://rancho333.github.io/pictures/lab_1.2.png"></p><p>结构很简单，涉及到三台设备：sw101,sw102,sw110，三台交换机之间通过portchannel连接，其中sw101和sw110之间走staic，其它两条走LACP。配置思路如下</p><ul><li>修复portchannel配置，打通二层连接</li><li>配置VTP，其中sw101作为VTP server, 另外两台作为vtp client</li><li>配置mst，其中sw101作为instance 0-1的根，sw102作为instance 2的根</li></ul><p>下面是实际配置：</p><ol><li>修复portchannel配置<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sw101：</span><br><span class="line">int range gi 1&#x2F;2-3</span><br><span class="line">    channel-group 1 mode on</span><br><span class="line">sw102:</span><br><span class="line">int range gi 1&#x2F;2-3</span><br><span class="line">    channel-group 2 mode active</span><br><span class="line">sw110:</span><br><span class="line">int range gi 1&#x2F;2-3</span><br><span class="line">    channel-group 2 mode active</span><br><span class="line">int port-channel 1</span><br><span class="line">    shutdown</span><br><span class="line">    no shutdown             &#x2F;&#x2F; po1是静态lag，对端修改配置后，本地down&#x2F;up使其获取最新状态</span><br></pre></td></tr></table></figure>配置完成之后，检查pc端口状态, pc全部都是<code>SU</code>状态，物理成员端口全部都是<code>P</code>状态，字母含义在show中有说明。</li></ol><p>sw101 pc端口状态</p><p><img src="https://rancho333.github.io/pictures/lab_1.2_pc_101.png"></p><p>sw102 pc端口状态</p><p><img src="https://rancho333.github.io/pictures/lab_1.2_pc_102.png"></p><p>三角拓扑检查两台设备即可确认所有pc端口状态</p><ol start="2"><li>配置VTP<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sw101:</span><br><span class="line">vtp domain CCIE</span><br><span class="line">vtp version 3</span><br><span class="line">vtp password cc1E@fab hidden</span><br><span class="line">vtp mode server MST</span><br><span class="line">vtp primary mst force           &#x2F;&#x2F; 特权模式下强制指定mst primary server, 需要输密码</span><br><span class="line"></span><br><span class="line">sw102&#x2F;sw110:</span><br><span class="line">vtp domain CCIE</span><br><span class="line">vtp version 3</span><br><span class="line">vtp password cc1E@fab hidden</span><br><span class="line">vtp mode client MST                 &#x2F;&#x2F; 注意sw102和sw110的vtp工作在client模式 </span><br></pre></td></tr></table></figure>配置完成之后检查vtp状态：</li></ol><p>sw101的vtp状态如下：</p><p><img src="https://rancho333.github.io/pictures/lab_1.2_vtp_101.png"></p><p>密码是hidden所以看不到明文：</p><p><img src="https://rancho333.github.io/pictures/lab_1.2_vtp_password_101.png"></p><p>sw102的vtp状态如下：</p><p><img src="https://rancho333.github.io/pictures/lab_1.2_vtp_102.png"></p><ol start="3"><li>配置mst<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sw101： </span><br><span class="line">spanning-tree mode mst              指定spanning tree模式为mst</span><br><span class="line">spanning-tree mst configuration</span><br><span class="line">    name CCIE</span><br><span class="line">    revision 1</span><br><span class="line">    instance 1 vlan 1001-2000</span><br><span class="line">    instance 2 vlan 2001-4094       &#x2F;&#x2F; mst的具体配置只需要在sw101上配置，之后会通过vtp同步给sw102和sw110</span><br><span class="line">spanning-tree mst 0-1 root primary      &#x2F;&#x2F; 指定sw101是instance 0-1的根</span><br><span class="line"></span><br><span class="line">sw102：</span><br><span class="line">spanning-tree mode mst              </span><br><span class="line">spanning-tree mst 2 root primary        &#x2F;&#x2F; 指定sw102是instance 2的根</span><br><span class="line"></span><br><span class="line">sw103:</span><br><span class="line">spaaning-tree mode mst</span><br></pre></td></tr></table></figure>配置完成之后检查mst状态，sw101作为instance 0-1根桥，sw102作为instance 2的根桥<br>sw101 spt状态</li></ol><p><img src="https://rancho333.github.io/pictures/lab_1.2_spt_101.png"></p><p>sw102 spt状态</p><p><img src="https://rancho333.github.io/pictures/lab_1.2_spt_102.png"></p><p>tips: sw102和sw110的VTP配置相同，spt配置基本相同，只是sw102多一个instance 2的根桥配置。复制粘贴配置即可。</p><p>后面的blog会按顺序逐题进行分析。</p>]]></content:encoded>
      
      
      
      <category domain="https://rancho333.github.io/tags/CCIE/">CCIE</category>
      
      
      <comments>https://rancho333.github.io/2023/06/19/lab%E8%80%83%E8%AF%95%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D%E5%8F%8A%E8%80%83%E9%A2%98%E5%88%86%E6%9E%901.2/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Questone2A_snake_traffic_test</title>
      <link>https://rancho333.github.io/2023/04/03/Questone2A_snake_traffic_test/</link>
      <guid>https://rancho333.github.io/2023/04/03/Questone2A_snake_traffic_test/</guid>
      <pubDate>Mon, 03 Apr 2023 01:00:38 GMT</pubDate>
      
      <description>&lt;h1 id=&quot;environment-description&quot;&gt;&lt;a href=&quot;#environment-description&quot; class=&quot;headerlink&quot; title=&quot;environment description&quot;&gt;&lt;/a&gt;environment description&lt;/h1&gt;&lt;p&gt;The experimental topology is shown in the figure:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://rancho333.github.io/pictures/questone2a_100G_snake_traffic_topology.png&quot;&gt;&lt;/p&gt;</description>
      
      
      
      <content:encoded><![CDATA[<h1 id="environment-description"><a href="#environment-description" class="headerlink" title="environment description"></a>environment description</h1><p>The experimental topology is shown in the figure:</p><p><img src="https://rancho333.github.io/pictures/questone2a_100G_snake_traffic_topology.png"></p><span id="more"></span><p>After the line is connected, do some configuration on ixia to make the port up. On sonic, link training and auto negotiation are disabled by default, and FEC is enabled. Set the corresponding interface on ixia to match it.</p><p>Make sure the port is up:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@sonic:&#x2F;home&#x2F;admin# show interfaces status Ethernet49-56</span><br><span class="line">  Interface        Lanes    Speed    MTU    FEC    Alias    Vlan    Oper    Admin             Type    Asym PFC</span><br><span class="line">-----------  -----------  -------  -----  -----  -------  ------  ------  -------  ---------------  ----------</span><br><span class="line"> Ethernet49  41,42,43,44     100G   9100     rs   100GE1  routed      up       up  QSFP28 or later         N&#x2F;A</span><br><span class="line"> Ethernet50  45,46,47,48     100G   9100     rs   100GE2  routed      up       up  QSFP28 or later         N&#x2F;A</span><br><span class="line"> Ethernet51  73,74,75,76     100G   9100     rs   100GE3  routed      up       up          Unknown         N&#x2F;A</span><br><span class="line"> Ethernet52  77,78,79,80     100G   9100     rs   100GE4  routed      up       up  QSFP28 or later         N&#x2F;A</span><br><span class="line"> Ethernet53      1,2,3,4     100G   9100     rs   100GE5  routed      up       up  QSFP28 or later         N&#x2F;A</span><br><span class="line"> Ethernet54  21,22,23,24     100G   9100     rs   100GE6  routed      up       up  QSFP28 or later         N&#x2F;A</span><br><span class="line"> Ethernet55     5,6,7,8,     100G   9100     rs   100GE7  routed      up       up  QSFP28 or later         N&#x2F;A</span><br><span class="line"> Ethernet56  25,26,27,28     100G   9100     rs   100GE8  routed      up       up  QSFP28 or later         N&#x2F;A</span><br></pre></td></tr></table></figure><h1 id="snake-traffic-test-for-100G"><a href="#snake-traffic-test-for-100G" class="headerlink" title="snake traffic test for 100G"></a>snake traffic test for 100G</h1><p>The ixia eth7 port sends out Layer 2 packets, the two sonic ports are in the same vlan, and the ixia eth8 port receives packets for statistics to check whether packets are lost. Similarly, eth8 sends packets, and eth7 receives packets. In this way, the bidirectional Layer 2 wire-speed streaming test is realized. The detailed steps are as follows:</p><p>sonic configuration:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">drivshell&gt;vlan clear</span><br><span class="line">vlan clear</span><br><span class="line">drivshell&gt;vlan remove 1 pbm&#x3D;ce</span><br><span class="line">vlan remove 1 pbm&#x3D;ce</span><br><span class="line">drivshell&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">drivshell&gt;vlan create 100 pbm&#x3D;ce1,ce2 ubm&#x3D;ce1,ce2; pvlan set ce1,ce2 100</span><br><span class="line">vlan create 101 pbm&#x3D;ce3,ce4 ubm&#x3D;ce3,ce4; pvlan set ce3,ce4 101</span><br><span class="line">vlan create 102 pbm&#x3D;ce5,ce7 ubm&#x3D;ce5,ce7; pvlan set ce5,ce7 102</span><br><span class="line">vlan create 100 pbm&#x3D;ce1,ce2 ubm&#x3D;ce1,ce2; pvlan set ce1,ce2 100</span><br><span class="line">vlan create 102 pbm&#x3D;ce5,ce7 ubm&#x3D;ce5,ce7; pvlan set ce5,ce7 102</span><br><span class="line">vlan create 103 pbm&#x3D;ce0,ce6 ubm&#x3D;ce0,ce6; pvlan set ce0,ce6 103</span><br><span class="line">drivshell&gt;vlan create 101 pbm&#x3D;ce3,ce4 ubm&#x3D;ce3,ce4; pvlan set ce3,ce4 101</span><br><span class="line">drivshell&gt;vlan create 102 pbm&#x3D;ce5,ce7 ubm&#x3D;ce5,ce7; pvlan set ce5,ce7 102</span><br><span class="line">drivshell&gt;vlan create 103 pbm&#x3D;ce0,ce6 ubm&#x3D;ce0,ce6; pvlan set ce0,ce6 103</span><br><span class="line">drivshell&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">drivshell&gt;vlan show</span><br><span class="line">vlan show</span><br><span class="line">vlan 1ports none (0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000), untagged none (0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000) MCAST_FLOOD_UNKNOWN</span><br><span class="line">vlan 100ports ce1-ce2 (0x000000000000000000000000000000000000000000000000000000000000000000000000000000000800000400000000), untagged ce1-ce2 (0x000000000000000000000000000000000000000000000000000000000000000000000000000000000800000400000000) MCAST_FLOOD_UNKNOWN</span><br><span class="line">vlan 101ports ce3-ce4 (0x000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000002), untagged ce3-ce4 (0x000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000002) MCAST_FLOOD_UNKNOWN</span><br><span class="line">vlan 102ports ce5,ce7 (0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018000), untagged ce5,ce7 (0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018000) MCAST_FLOOD_UNKNOWN</span><br><span class="line">vlan 103ports ce0,ce6 (0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000004), untagged ce0,ce6 (0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000004) MCAST_FLOOD_UNKNOWN</span><br><span class="line">drivshell&gt;</span><br></pre></td></tr></table></figure><p>Then create two Layer 2 stream:<br><img src="https://rancho333.github.io/pictures/questone2a_100G_snake_traffic_traffic.png"></p><p>The picture shows eth7 sending and eth8 receiving and checking. Similarly, reverse flow is created to realize bidirectional streaming test. Note that it is better to modify the source and destination MAC addresses of Layer 2 packets.</p><p>Final streaming test:<br><img src="https://rancho333.github.io/pictures/questone2a_snake_traffic_100G_result.png"></p><p>As you can see， no packet loss.</p><p>Check the packets counters in Bcmsh.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">drivshell&gt;show c CLMIB_RPOK.ce</span><br><span class="line">show c CLMIB_RPOK.ce</span><br><span class="line">CLMIB_RPOK.ce0    :     23,803,850,505    +13       1&#x2F;s</span><br><span class="line">CLMIB_RPOK.ce1    :     30,512,888,521    +13       1&#x2F;s</span><br><span class="line">CLMIB_RPOK.ce2    :     23,803,849,548     +8</span><br><span class="line">CLMIB_RPOK.ce3    :     30,512,889,476     +8</span><br><span class="line">CLMIB_RPOK.ce4    :     23,803,848,543    +11       1&#x2F;s</span><br><span class="line">CLMIB_RPOK.ce5    :     30,512,890,437    +11       1&#x2F;s</span><br><span class="line">drivshell&gt;show c CLMIB_RFCS</span><br><span class="line">show c CLMIB_RFCS</span><br><span class="line">drivshell&gt;</span><br></pre></td></tr></table></figure><h1 id="snake-traffic-test-for-25G"><a href="#snake-traffic-test-for-25G" class="headerlink" title="snake traffic test for 25G"></a>snake traffic test for 25G</h1><p>Ixia don’t have 25G ports, so i use 100G of ixia connet to 100G port of Questone2A and just send 25% line rate to test 25G port of Questone2A. The test environment tpology is show as below picture.<br><img src="https://rancho333.github.io/pictures/questone2a_snake_traffic_25G_topology.png"></p><p>sonic configuration:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">drivshell&gt;vlan clear</span><br><span class="line">vlan clear</span><br><span class="line">drivshell&gt;vlan remove 1 pbm&#x3D;ce</span><br><span class="line">vlan remove 1 pbm&#x3D;ce</span><br><span class="line">drivshell&gt;vlan remove 1 pbm&#x3D;xe</span><br><span class="line">vlan remove 1 pbm&#x3D;xe</span><br><span class="line"></span><br><span class="line">drivshell&gt;vlan create 100 pbm&#x3D;xe1,xe2 ubm&#x3D;xe1,xe2; pvlan set xe1,xe2 100</span><br><span class="line">23,xe24; pvlan set xe23,xe24 111</span><br><span class="line">vlan create 112 pbm&#x3D;xe25,xe26 ubm&#x3D;xe25,xe26; pvlan set xe25,xe26 112</span><br><span class="line">vlan create 113 pbm&#x3D;xe27,xe28 ubm&#x3D;xe27,xe28; pvlan set xe27,xe28 113</span><br><span class="line">vlan create 114 pbm&#x3D;xe29,xe30 ubm&#x3D;xe29,xe30; pvlan set xe29,xe30 114</span><br><span class="line">pbm&#x3D;xe31,xe32 ubm&#x3D;xe31,xe32; pvlan set xe31,xe32 115</span><br><span class="line">vlan create 116 pbm&#x3D;xe33,xe34 ubm&#x3D;xe33,xe34; pvlan set xe33,xe34 116</span><br><span class="line">vlan create 117 pbm&#x3D;xe35,xe36 ubm&#x3D;xe35,xe36; pvlan set xe35,xe36 117</span><br><span class="line">vlan create 118 pbm&#x3D;xe37,xe38 ubm&#x3D;xe37,xe38; pvlan set xe37,xe38 vlan create 101 pbm&#x3D;xe3,xe4 ubm&#x3D;xe3,xe4; pvlan set xe3,xe4 101</span><br><span class="line">vlan create 102 pbm&#x3D;xe5,xe6 ubm&#x3D;xe5,xe6; pvlan set xe5,xe6 102</span><br><span class="line">vlan create 100 pbm&#x3D;xe1,xe2 ubm&#x3D;xe1,xe2; pvlan set xe1,xe2 100</span><br><span class="line">vlan create 101 pbm&#x3D;xe3,xe4 ubm&#x3D;xe3,xe4; pvlan set xe3,xe4 101</span><br><span class="line">vlan create 102 pbm&#x3D;xe5,xe6 ubm&#x3D;xe5,xe6; pvlan set xe5,xe6 102</span><br><span class="line">vlan create 103 pbm&#x3D;xe7,xe8 ubm&#x3D;xe7,xe8; pvlan set xe7,xe8 103</span><br><span class="line">drivshell&gt;vlan create 101 pbm&#x3D;xe3,xevlan create 104 pbm&#x3D;xe9,xe10 ubm&#x3D;xe9,xe10; pvlan set xe9,xe10 104</span><br><span class="line">4 ubm&#x3D;xe3,xe4; pvlan set xe3,xe4 101</span><br><span class="line">vlan create 104 pbm&#x3D;xe9,xe10 ubm&#x3D;xe9,xe10; pvlan set xe9,xe10 104</span><br><span class="line">vlan create 105 pbm&#x3D;xe11,xe12 ubm&#x3D;xe11,xe12; pvlan set xe11,xe12 105</span><br><span class="line">vlan create 106 pbm&#x3D;xe13,xe14 ubm&#x3D;xe13,xe14; pvlan set xe13,xe14 106</span><br><span class="line">vlan create 105 pbm&#x3D;xe11,xe12 ubm&#x3D;xe11,xe12; pvlan set xe11,xe12 105</span><br><span class="line">drivshell&gt;vlan create 102vlan create 107 pbm&#x3D;xe15,xe16 ubm&#x3D;xe15,xe16; pvlan set xe15,xe16 107</span><br><span class="line"> pbm&#x3D;xe5,xe6 ubm&#x3D;xe5,xe6; pvlan set vlan create 108 pbm&#x3D;xe17,xe18 ubm&#x3D;xe17,xe18; pvlan set xe17,xe18 108</span><br><span class="line">vlan create 109 pbm&#x3D;xe19,xe20 ubm&#x3D;xe19,xe20; pvlan set xe19,xe20 109</span><br><span class="line">xe5,xe6 102</span><br><span class="line">vlan create 108 pbm&#x3D;xe17,xe18 ubm&#x3D;xe17,xe18; pvlan set xe17,xe18 108</span><br><span class="line">drivshell&gt;vlan create 103 pbm&#x3D;xe7,xe8 ubm&#x3D;xe7,xe8; pvlan set xe7,xe8 103</span><br><span class="line">vlan create 109 pbm&#x3D;xe19,xe20 ubm&#x3D;xe19,xe20; pvlan set xe19,xe20 109</span><br><span class="line">vlan create 110 pbm&#x3D;xe21,xe22 ubm&#x3D;xe21,xe22; pvlan set xe21,xe22 110</span><br><span class="line">vlan create 111 pbm&#x3D;xe23,xe24 ubm&#x3D;xe23,xe24; pvlan set xe23,xe24 111</span><br><span class="line">vlan create 110 pbm&#x3D;xe21,xe22 ubm&#x3D;xe21,xe22; pvlan set xe21,xe22 110</span><br><span class="line">vlan create 111 pbm&#x3D;xe23,xe24 ubm&#x3D;xe23,xe24; pvlan set xe23,xe24 111</span><br><span class="line">vlan create 112 pbm&#x3D;xe25,xe26 ubm&#x3D;xe25,xe26; pvlan set xe25,xe26 112</span><br><span class="line">vlan create 113 pbm&#x3D;xe27,xe28 ubm&#x3D;xe27,xe28; pvlan set xe27,xe28 113</span><br><span class="line">drivshell&gt;vlan create 104 pbm&#x3D;xe9,xe10 ubm&#x3D;xe9,xe10; pvlan set xe9,xe10 104</span><br><span class="line">vlan create 112 pbm&#x3D;xe25,xe26 ubm&#x3D;xe25,xe26; pvlan set xe25,xe26 112</span><br><span class="line">drivshell&gt;vlan create 105 pbm&#x3D;xe11,xe12 ubm&#x3D;xe11,xe12; pvlan set xe11,xe12 105</span><br><span class="line">vlan create 113 pbm&#x3D;xe27,xe28 ubm&#x3D;xe27,xe28; pvlan set xe27,xe28 113</span><br><span class="line">vlan create 114 pbm&#x3D;xe29,xe30 ubm&#x3D;xe29,xe30; pvlan set xe29,xe30 114</span><br><span class="line">vlan create 115 pbm&#x3D;xe31,xe32 ubm&#x3D;xe31,xe32; pvlan set xe31,xe32 115</span><br><span class="line">vlan create 114 pbm&#x3D;xe29,xe30 ubm&#x3D;xe29,xe30; pvlan set xe29,xe30 114</span><br><span class="line">vlan create 115 pbm&#x3D;xe31,xe32 ubm&#x3D;xe31,xe32; pvlan set xe31,xe32 115</span><br><span class="line">vlan create 116 pbm&#x3D;xe33,xe34 ubm&#x3D;xe33,xe34; pvlan set xe33,xe34 116</span><br><span class="line">vlan create 117 pbm&#x3D;xe35,xe36 ubm&#x3D;xe35,xe36; pvlan set xe35,xe36 117</span><br><span class="line">vlan create 116 pbm&#x3D;xe33,xe34 ubm&#x3D;xe33,xe34; pvlan set xe33,xe34 116</span><br><span class="line">vlan create 117 pbm&#x3D;xe35,xe36 ubm&#x3D;xe35,xe36; pvlan set xe35,xe36 117</span><br><span class="line">vlan create 118 pbm&#x3D;xe37,xe38 ubm&#x3D;xe37,xe38; pvlan set xe37,xe38 118</span><br><span class="line">vlan create 119 pbm&#x3D;xe39,xe40 ubm&#x3D;xe39,xe40; pvlan set xe39,xe40 119</span><br><span class="line">vlan create 118 pbm&#x3D;xe37,xe38 ubm&#x3D;xe37,xe38; pvlan set xe37,xe38 118</span><br><span class="line">drivshell&gt;vlan create 106 pbm&#x3D;xe13,xe14 ubm&#x3D;xe13,xe14; pvlan set xe13,xe14 106</span><br><span class="line">vlan create 119 pbm&#x3D;xe39,xe40 ubm&#x3D;xe39,xe40; pvlan set xe39,xe40 119</span><br><span class="line">vlan create 120 pbm&#x3D;xe41,xe42 ubm&#x3D;xe41,xe42; pvlan set xe41,xe42 120</span><br><span class="line">vlan create 121 pbm&#x3D;xe43,xe44 ubm&#x3D;xe43,xe44; pvlan set xe43,xe44 121</span><br><span class="line">vlan create 120 pbm&#x3D;xe41,xe42 ubm&#x3D;xe41,xe42; pvlan set xe41,xe42 120</span><br><span class="line">drivshell&gt;vlan vlan create 122 pbm&#x3D;xe45,xe46 ubm&#x3D;xe45,xe46; pvlan set xe45,xe46 122</span><br><span class="line">create 107 pbm&#x3D;xe15,xe16 ubm&#x3D;xe15,xe16; pvlan set xe15,xe16 107</span><br><span class="line">drivshell&gt;vlan create 108 pbm&#x3D;xe17,xe18 ubm&#x3D;xe17,xe18; pvlan set xe17,xe18 108</span><br><span class="line">drivshell&gt;vlan create 109 pbm&#x3D;xe19,xe20 ubm&#x3D;xe19,xe20; pvlan set xe19,xe20 109</span><br><span class="line">vlan create 122 pbm&#x3D;xe45,xe46 ubm&#x3D;xe45,xe46; pvlan set xe45,xe46 122</span><br><span class="line">vlan create 123 pbm&#x3D;ce6,xe0 ubm&#x3D;ce6,xe0; pvlan set ce6,xe0 123</span><br><span class="line">vlan create 124 pbm&#x3D;ce7,xe47 ubm&#x3D;ce7,xe47; pvlan set ce7,xe47 124</span><br><span class="line">vlan create 123 pbm&#x3D;ce6,xe0 ubm&#x3D;ce6,xe0; pvlan set ce6,xe0 123</span><br><span class="line">drivshell&gt;vlan create 110 pbm&#x3D;xe21,xe22 ubm&#x3D;xe21,xe22; pvlan set xe21,xe22 110</span><br><span class="line">drivshell&gt;vlan create 111 pbm&#x3D;xe23,xe24 ubm&#x3D;xe23,xe24; pvlan set xe23,xe24 111</span><br><span class="line">drivshell&gt;vlan create 112 pbm&#x3D;xe25,xe26 ubm&#x3D;xe25,xe26; pvlan set xe25,xe26 112</span><br><span class="line">drivshell&gt;vlan create 113 pbm&#x3D;xe27,xe28 ubm&#x3D;xe27,xe28; pvlan set xe27,xe28 113</span><br><span class="line">drivshell&gt;vlan create 114 pbm&#x3D;xe29,xe30 ubm&#x3D;xe29,xe30; pvlan set xe29,xe30 114</span><br><span class="line">drivshell&gt;vlan create 115 pbm&#x3D;xe31,xe32 ubm&#x3D;xe31,xe32; pvlan set xe31,xe32 115</span><br><span class="line">drivshell&gt;vlan create 116 pbm&#x3D;xe33,xe34 ubm&#x3D;xe33,xe34; pvlan set xe33,xe34 116</span><br><span class="line">drivshell&gt;vlan create 117 pbm&#x3D;xe35,xe36 ubm&#x3D;xe35,xe36; pvlan set xe35,xe36 117</span><br><span class="line">drivshell&gt;vlan create 118 pbm&#x3D;xe37,xe38 ubm&#x3D;xe37,xe38; pvlan set xe37,xe38 118</span><br><span class="line">drivshell&gt;vlan create 119 pbm&#x3D;xe39,xe40 ubm&#x3D;xe39,xe40; pvlan set xe39,xe40 119</span><br><span class="line">drivshell&gt;vlan create 120 pbm&#x3D;xe41,xe42 ubm&#x3D;xe41,xe42; pvlan set xe41,xe42 120</span><br><span class="line">drivshell&gt;vlan create 121 pbm&#x3D;xe43,xe44 ubm&#x3D;xe43,xe44; pvlan set xe43,xe44 121</span><br><span class="line">drivshell&gt;vlan create 122 pbm&#x3D;xe45,xe46 ubm&#x3D;xe45,xe46; pvlan set xe45,xe46 122</span><br><span class="line">drivshell&gt;vlan create 123 pbm&#x3D;ce6,xe0 ubm&#x3D;ce6,xe0; pvlan set ce6,xe0 123</span><br><span class="line">drivshell&gt;vlan create 124 pbm&#x3D;ce7,xe47 ubm&#x3D;ce7,xe47; pvlan set ce7,xe47 124</span><br><span class="line">drivshell&gt;</span><br></pre></td></tr></table></figure><p>ixia is configured as follows:<br><img src="https://rancho333.github.io/pictures/questone2a_snake_traffic_25G_ixia.png"></p><p>Finally, start the test to check the packet loss:<br><img src="https://rancho333.github.io/pictures/questone2a_snake_traffic_25G_result.png"></p><p>Check the packets counters in Bcmsh.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">drivshell&gt;show c CLMIB_TPKT.xe</span><br><span class="line">show c CLMIB_TPKT.xe</span><br><span class="line">CLMIB_TPKT.xe0    :      1,347,751,223     +6</span><br><span class="line">CLMIB_TPKT.xe1    :      1,347,716,171   +154       8&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe2    :      1,347,683,168    +12</span><br><span class="line">CLMIB_TPKT.xe3    :      1,347,660,881   +148       8&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe4    :      1,347,633,886    +18</span><br><span class="line">CLMIB_TPKT.xe5    :      1,347,611,124   +142       8&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe6    :      1,347,585,268    +24</span><br><span class="line">CLMIB_TPKT.xe7    :      1,347,562,390   +136       8&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe8    :      1,347,536,351    +30</span><br><span class="line">CLMIB_TPKT.xe9    :      1,347,513,095   +130       8&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe10     :      1,347,486,710    +38       1&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe11     :      1,347,463,552   +125       8&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe12     :      1,347,389,466    +45       2&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe13     :      1,347,366,188   +118       7&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe14     :      1,347,341,022    +50       2&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe15     :      1,347,317,516   +109       5&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe16     :      1,347,292,618    +57       3&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe17     :      1,347,269,117   +102       4&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe18     :      1,347,243,912    +64       3&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe19     :      1,347,215,748    +95       3&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe20     :      1,347,191,194    +69       3&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe21     :      1,347,166,549    +88       3&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe22     :      1,347,141,524    +78       4&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe23     :      1,347,116,886    +83       3&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe24     :      1,348,186,469    +83       4&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe25     :      1,348,161,948    +74       1&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe26     :      1,348,136,316    +90       4&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe27     :      1,348,106,807    +69       1&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe28     :      1,348,079,919    +95       4&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe29     :      1,348,048,460    +62       1&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe30     :      1,348,018,298   +102       4&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe31     :      1,347,983,062    +57       1&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe32     :      1,347,951,303   +107       4&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe33     :      1,347,917,231    +50       1&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe34     :      1,347,886,358   +116       5&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe35     :      1,347,853,385    +45       1&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe36     :      1,347,092,884   +121       5&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe37     :      1,347,067,278    +38       1&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe38     :      1,347,043,968   +127       5&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe39     :      1,347,017,351    +32       1&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe40     :      1,346,994,279   +135       6&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe41     :      1,346,968,532    +26       1&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe42     :      1,346,946,104   +142       6&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe43     :      1,346,917,004    +19</span><br><span class="line">CLMIB_TPKT.xe44     :      1,346,894,475   +148       7&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe45     :      1,346,866,979    +12</span><br><span class="line">CLMIB_TPKT.xe46     :      1,346,843,674   +154       7&#x2F;s</span><br><span class="line">CLMIB_TPKT.xe47     :      1,346,816,974     +6</span><br><span class="line">drivshell&gt;</span><br><span class="line">drivshell&gt;show c CLMIB_RFCS</span><br><span class="line">show c CLMIB_RFCS</span><br><span class="line">drivshell&gt;</span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      
      
      <comments>https://rancho333.github.io/2023/04/03/Questone2A_snake_traffic_test/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Questone2A_25G_line_rate_test</title>
      <link>https://rancho333.github.io/2023/03/27/Questone2A_25G_line_rate_test/</link>
      <guid>https://rancho333.github.io/2023/03/27/Questone2A_25G_line_rate_test/</guid>
      <pubDate>Mon, 27 Mar 2023 01:00:38 GMT</pubDate>
      
      <description>&lt;h1 id=&quot;environment-description&quot;&gt;&lt;a href=&quot;#environment-description&quot; class=&quot;headerlink&quot; title=&quot;environment description&quot;&gt;&lt;/a&gt;environment description&lt;/h1&gt;&lt;p&gt;The experimental topology is shown in the figure:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://rancho333.github.io/pictures/questone2a_25G_topology.png&quot;&gt;&lt;/p&gt;</description>
      
      
      
      <content:encoded><![CDATA[<h1 id="environment-description"><a href="#environment-description" class="headerlink" title="environment description"></a>environment description</h1><p>The experimental topology is shown in the figure:</p><p><img src="https://rancho333.github.io/pictures/questone2a_25G_topology.png"></p><span id="more"></span><p>We only need add one ixia 100G port to topology, and set the line rate of 25 percent to test Questone2A 25G ports.<br><img src="https://rancho333.github.io/pictures/questone2a_25G_ixia_topology.png"></p><p>For Questone2A, follow the below cmds to set up test enviorments.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vlan clear              </span><br><span class="line">vlan remove 1 pbm&#x3D;ce       </span><br><span class="line">vlan remove 1 pbm&#x3D;xe </span><br><span class="line"></span><br><span class="line">vlan create 103 pbm&#x3D;xe0,ce0 ubm&#x3D;xe0,ce0; pvlan set xe0,ce0 103</span><br><span class="line">vlan create 100 pbm&#x3D;xe1,xe2 ubm&#x3D;xe1,xe2; pvlan set xe1,xe2 100</span><br><span class="line">vlan create 101 pbm&#x3D;xe3,xe4 ubm&#x3D;xe3,xe4; pvlan set xe3,xe4 101</span><br><span class="line">vlan create 102 pbm&#x3D;xe5,xe6 ubm&#x3D;xe5,xe6; pvlan set xe5,xe6 102</span><br><span class="line">vlan create 104 pbm&#x3D;xe7,ce0 ubm&#x3D;xe7,ce0; pvlan set xe7,ce0 104</span><br></pre></td></tr></table></figure><p>We test three different(20,25,30) line rate speed, and expect no packets loss when line rate under 25 percent.</p><p>We use default preemphasis and differnet FEC setting to test line rate of 25G port.</p><h2 id="FEC-fc"><a href="#FEC-fc" class="headerlink" title="FEC fc"></a>FEC fc</h2><p>For fec mode of fc，ports status show as below picture.<br><img src="https://rancho333.github.io/pictures/questone2a_25g_fec_fc.png"></p><h3 id="Line-rate-20-percent"><a href="#Line-rate-20-percent" class="headerlink" title="Line rate 20 percent"></a>Line rate 20 percent</h3><p>Just set line rate 20 percent on ixia like below picture.<br><img src="https://rancho333.github.io/pictures/questone2a_line_rate_20.png"></p><p>Test results show as below picture and meet expectations.<br><img src="https://rancho333.github.io/pictures/questone2a_line_rate_20_result.png"></p><h3 id="Line-rate-25-percent"><a href="#Line-rate-25-percent" class="headerlink" title="Line rate 25 percent"></a>Line rate 25 percent</h3><p>Test results show as below picture and meet expectations.<br><img src="https://rancho333.github.io/pictures/questone2a_line_rate_25.png"></p><h3 id="Line-rate-30-percent"><a href="#Line-rate-30-percent" class="headerlink" title="Line rate 30 percent"></a>Line rate 30 percent</h3><p>Test results show as below picture and packets loss.<br><img src="https://rancho333.github.io/pictures/questone2a_line_rate_30.png"></p><h2 id="Fec-none"><a href="#Fec-none" class="headerlink" title="Fec none"></a>Fec none</h2><p>For fec mode of none, ports status show as below picture.<br><img src="https://rancho333.github.io/pictures/questone2a_25_fec_none.png"></p><h3 id="Line-rate-20-percent-1"><a href="#Line-rate-20-percent-1" class="headerlink" title="Line rate 20 percent"></a>Line rate 20 percent</h3><p>For fec mode of none, ports status show as below picture.<br><img src="https://rancho333.github.io/pictures/questone2a_line_rate_20_none.png"></p><h3 id="Line-rate-25-percent-1"><a href="#Line-rate-25-percent-1" class="headerlink" title="Line rate 25 percent"></a>Line rate 25 percent</h3><p>For fec mode of none, ports status show as below picture.<br><img src="https://rancho333.github.io/pictures/questone2a_line_rate_25_none.png"></p><h3 id="Line-rate-30-percent-1"><a href="#Line-rate-30-percent-1" class="headerlink" title="Line rate 30 percent"></a>Line rate 30 percent</h3><p>Test results show as below picture and packets loss.<br><img src="https://rancho333.github.io/pictures/questone2a_line_rate_30_none.png"></p>]]></content:encoded>
      
      
      
      
      <comments>https://rancho333.github.io/2023/03/27/Questone2A_25G_line_rate_test/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
